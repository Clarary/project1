<!-- saved from url=(0040)http://202.197.71.136/xlxt/stk/index.asp -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- 由开发人员工具生成。它可能不是原始源文件的准确表示形式 -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>线性代数试题库</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META content=IE=EmulateIE7 http-equiv=X-UA-Compatible><LINK rel=stylesheet type=text/css href="styles/publicDefine.css"><LINK rel=stylesheet type=text/css href="styles/index_2.css">
<SCRIPT language=javascript src="js/table.js"></SCRIPT>

<SCRIPT language=javascript src="js/time.js"></SCRIPT>
</HEAD>
<BODY oncontextmenu=window.event.returnValue=false topMargin=0 windowc_onresizez="true"><IFRAME style="Z-INDEX: 9998; POSITION: absolute; DISPLAY: none" id=endDateLayer height=211 frameBorder=0 width=162></IFRAME>
<SCRIPT language=vbscript>
function bytes2BSTR(vIn)
dim strReturn,i,ThisCharCode,innerCode,Hight8,Low8,NextCharCode
strReturn=""
for i=1 to LenB(vIn)
ThisCharCode=AscB(MidB(vIn,i,1))
if ThisCharCode<&H80 Then
strReturn=strReturn & Chr(ThisCharCode)
else
NextCharCode=AscB(MidB(vIn,i+1,1))
strReturn=strReturn&Chr(CLng(ThisCharCode)*&H100+CInt(NextCharCode))
i=i+1
end if
next
bytes2BSTR=strReturn
end function
</SCRIPT>

<SCRIPT language=javascript>
var FoldersType,ShareType;
var CType;
var KnowledgeShowStyle = '2';
var Library = 1;
var NowKnowledgeID=0;
var TitleID = "";
var NowName;
var AddType;
var SaveKindID=0;
var ObjTemp;
var type = '';
var MoveTable;
var MoveRow;
var onMouseDown = false;
var ButtonType = "stzj";
var CSaveKindID;
var CopyType;
var CopySaveKindID;
$= function (id) { return document.getElementById(id); }
function getX(obj)
{
      return obj.offsetLeft+(obj.offsetParent?getX(obj.offsetParent):obj.x?obj.x:0);    
}      
function getY(obj)
 {    
      return (obj.offsetParent?obj.offsetTop+getY(obj.offsetParent):obj.y?obj.y:0);    
} 
function ShowStyleChange1()
{
	if ( !$("Share1").checked && !$("Self1").checked )
	{
		$("Share1").checked = true;
		KnowledgeShowStyle = 0;
	}
	if ( $("Share1").checked && !$("Self1").checked )
	{
		KnowledgeShowStyle = 0;
	}
	if ( !$("Share1").checked && $("Self1").checked )
	{
		KnowledgeShowStyle = 1;
	} 
	if ( $("Share1").checked && $("Self1").checked )
	{
		KnowledgeShowStyle = 2;
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=ChangeShowStyle&CourseID=2&KnowledgeShowStyle=" + KnowledgeShowStyle,false);
	xmlhttp.send();	
	if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
	{
		//var classname = $("KB_0").className;
		$("KnowledgeBuilding_Content1").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);		
		//$("KB_0").className = classname;	
	}
}
function ShowStyleChange()
{
	if ( !$("Share").checked && !$("Self").checked )
	{
		$("Share").checked = true;
		KnowledgeShowStyle = 0;
	}
	if ( $("Share").checked && !$("Self").checked )
	{
		KnowledgeShowStyle = 0;
	}
	if ( !$("Share").checked && $("Self").checked )
	{
		KnowledgeShowStyle = 1;
	} 
	if ( $("Share").checked && $("Self").checked )
	{
		KnowledgeShowStyle = 2;
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=ChangeShowStyle&CourseID=2&KnowledgeShowStyle=" + KnowledgeShowStyle,false);
	xmlhttp.send();	
	if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
	{
		var classname = $("KB_0").className;
		$("KnowledgeBuilding_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);		
		$("KB_0").className = classname;	
	}
}
function TMoveRow1(obj)
{	
	if ( onMouseDown == false ) {return;}		
	if ( MoveRow.rowIndex!=obj.rowIndex )
	{
		moveCell(MoveTable,MoveRow.rowIndex,obj.rowIndex);
		//MoveRow.id = MoveRow.rowIndex ;
	}		
	$("KnowledgeTemple_Content_1").style.cursor = "default";
	onMouseDown = false;
}
function TMoveRow2(obj)
{	
	if ( onMouseDown == false ) {return;}		
	if ( MoveRow.rowIndex!=obj.rowIndex )
	{
		moveCell(MoveTable,MoveRow.rowIndex,obj.rowIndex);
		//MoveRow.id = MoveRow.rowIndex ;
	}		
	$("KnowledgeTemple_Content_1").style.cursor = "default";
	onMouseDown = false;
}
function TMoveRow(obj)
{	
	if ( onMouseDown == false || ButtonType != "kdsz" ) {return;}
	if ( MoveTable.id == obj.parentNode.parentNode.id )
	{
		if ( MoveRow.rowIndex!=obj.rowIndex )
		{			
			var MRrowIndex = MoveRow.rowIndex;
			moveCell(MoveTable,MoveRow.rowIndex,obj.rowIndex);			
			if ( MoveTable.rows[MRrowIndex+1].id.indexOf("Next")>=0 )
			{
				moveCell(MoveTable,MRrowIndex+1,MoveRow.rowIndex+1);
			}
			var sDefine = 1;
			for (i=0;i<MoveTable.rows.length;i++)
			{
				if ( MoveTable.rows[i].id.indexOf("Next")<0 )
				{
					var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
					xmlhttp.open("GET","knowledge.asp?DoType=ChangeSortDefine&KnowledgeID="+MoveTable.rows[i].id.substring(3,MoveTable.rows[i].id.length)+"&SortDefine="+sDefine,false);
					xmlhttp.send();
					sDefine++;
				}
			}
			
		}
	}
	else
	{
		alert('请在同级间进行移动！')
	}
	$("KnowledgeBuilding_Content").style.cursor = "default";
	onMouseDown = false;
}
function ShowRight(WinName,obj,ShareT)
{
	if ( ButtonType != "kdsz" ) { return;}
	if ( WinName.id == "KWindow_0" && ($("KWindow").style.display == "block" || $("KWindowz").style.display == "block"))
	{
		return;
	}	
	if ( ShareT != null ) { ShareType = ShareT;}
	if(window.event.button==1)
	{
		if ( obj == null ){ return;}
		if ( obj.parentNode.parentNode )
		{
			MoveTable = obj.parentNode.parentNode;
			MoveRow = obj;
			onMouseDown = true;
			$("KnowledgeBuilding_Content").style.cursor = "move";
		}
	}
	if((parseInt(window.event.button)%2) ==0)
	{	
		WinName.style.display = "block";
		var x=document.documentElement.scrollLeft + event.x;
        var y= event.y;	
		if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   {
			  y = document.documentElement.scrollTop + y;
	   }
		WinName.style.left = x;
		if ( y > 500 )
		{
			y= y - WinName.offsetHeight;
		}
		WinName.style.top = y;			
	}
	if( WinName.id.indexOf("_")>0 && ($("KWindow").style.display == "block" || $("KWindowz").style.display == "block") && obj != null)
	{
		WinName.style.display = "block";
		var x=getX(obj)+100;
        var y=getY(obj)+2;
		if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   {
			  y = document.documentElement.scrollTop + y;
	   }
		WinName.style.left = x;
		WinName.style.top = y;		
	}
}
function ShowNext(KnowledgeID,CourseID)
{	
	var NextName = "Next_" + KnowledgeID;
	var ImgName = "img_" + KnowledgeID;	
	var TrName = "tr_" + KnowledgeID;
	if ( !$(ImgName) ) { return false;}
	if ( $(ImgName).src.indexOf("fclose") > 0 )
	{
		$(NextName).style.display = "none";
		if ( $(ImgName).src.indexOf("fcloses") > 0 )
		{
			$(ImgName).src = "images/new/fopens.gif";
		}
		else
		{
			$(ImgName).src = "images/new/fopen.gif";
		}
	}
	else
	{
		$(NextName).style.display = "block";
		if ( $(ImgName).src.indexOf("fopens") > 0 )
		{
			$(ImgName).src = "images/new/fcloses.gif";
		}
		else
		{
			$(ImgName).src = "images/new/fclose.gif";
		}
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		if ( $(TrName).cells[1].innerHTML.indexOf("..") >=0 )
		{
			xmlhttp.open("GET","knowledge.asp?DoType=CallKnowledgeRightNum&CourseID="+CourseID+"&KnowledgeID="+KnowledgeID,false);
			xmlhttp.send();
			$(TrName).cells[1].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}
		if ( $(NextName).cells[0].innerHTML == "")
		{			
			xmlhttp.open("GET","knowledge.asp?ButtonType="+ ButtonType + "&DoType=CallKnowledge&CourseID="+CourseID+"&KnowledgeID="+KnowledgeID,false);
			xmlhttp.send();
			$(NextName).cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}	
	}	
}
function ChangeBg1(Obj)
{
	Obj.cells[0].style.backgroundColor = "#c0dbfa";
	Obj.cells[1].style.backgroundColor = "#c0dbfa";
	Obj.cells[2].style.backgroundColor = "#c0dbfa";
}
function ChangeBg(Obj)
{
	Obj.cells[0].style.backgroundColor = "#c0dbfa";
	Obj.cells[1].style.backgroundColor = "#c0dbfa";
	if ( ($("KWindow").style.display == "none" || $("KWindow").style.display == "") && ($("KWindowz").style.display == "none" || $("KWindowz").style.display == ""))
	{
		NowKnowledgeID = parseInt(Obj.id.substring(Obj.id.indexOf("_")+1,Obj.length));
	}
	if ( $("KWindow").style.display == "block" || $("KWindowz").style.display == "block" )
	{
		$("KWindow").style.display = "none"; 
		$("KWindowz").style.display = "none";
		$("KWindow_1").style.display = "none";
	}	
	$("KWindow_0").style.display = "none";
}
function BackBg1(Obj)
{
	Obj.cells[0].style.backgroundColor = "";
	Obj.cells[1].style.backgroundColor = "";
	Obj.cells[2].style.backgroundColor = "";	
}
function BackBg(Obj)
{
	Obj.cells[0].style.backgroundColor = "";
	Obj.cells[1].style.backgroundColor = "";	
	$("ShowK").style.display = "none";
}
function ShowCourse(){
	var WinName = $("CourseWindow")
	if ( WinName.style.display == "none" )
	{
		WinName.style.display = "block";	
		var x=getX($("CourseName"))+0;
		var y=getY($("CourseName"))+5;
		WinName.style.left = x;
		WinName.style.top = y;
	}
	else
	{
		WinName.style.display = "none";
	}
}
function ChangeCWBg(obj){
	obj.style.backgroundColor = "#005ba6";
}
function BackCWBg(obj){
	obj.style.backgroundColor = "#088dd0";
}
function ChangeCourse(course)
{
	$("CourseWindow").style.display = "none";
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=ChangeCourse&CourseID="+course,false);
	xmlhttp.send();	
	window.location.href = "index.asp";
}
var TestLibraryLimit = '0'
if ( TestLibraryLimit == '' ) { TestLibraryLimit=1;}
var xmlHTTP
//建立XMLHTTP对象调用MS的ActiveXObject方法，如果成功（IE浏览器）则使用MS ActiveX实例化创建一个XMLHTTP对象 非IE则转用建立一个本地Javascript对象的XMLHttp对象（此方法确保不同浏览器下对AJAX的支持）
function createXMLHttp()
{
	if(window.XMLHttpRequest)
	{ // Mozilla 浏览器
		xmlHTTP = new XMLHttpRequest();
	}else if (window.ActiveXObject){ // IE 浏览器
		try{
			xmlHTTP = new ActiveXObject("Msxml2.XMLHTTP");
		}catch(e){
			try{
				xmlHTTP = new ActiveXObject("Microsoft.XMLHTTP");
			}catch(e){}
		}
	}
}
function ChangeNum(KnowledgeID)
{
	var KID = KnowledgeID;
	var trName= "tr_" + KID;
	var obj=$(trName);	
	do
	{
		trName = "tr_" + KID;		
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeNum&KnowledgeID="+KID,false);
		xmlhttp.send();
		if ($(trName))
		{
			
			obj = $(trName).cells[0].firstChild;
			obj.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			if ( ButtonType == "kdjs" )
			{
				var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
				xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeTypeNum&KnowledgeID="+KID,false);
				xmlhttp.send();
				$(trName).cells[1].firstChild.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			obj = $(trName).parentNode.parentNode;
			KID = obj.parentNode.parentNode.id;
		}
		if ( KID.indexOf("Next") >= 0 ) { KID = KID.substring(5,KID.length);}
	}while(obj.id!="KB_0");
}
function ChangeNote(obj)
{	
	if($("KnowledgeDetail").style.display == "block")
	{
		window.frames["eWebEditor"].AttachSubmit();
		obj = $(obj);
	}
	if ( obj.value != "" )
	{		
		var KnID;
		if($("KnowledgeDetail").style.display == "none")
		{
			KnID = obj.id.substring(obj.id.indexOf("_")+1,obj.id.length);
		}
		else
		{			
			KnID = $("KnowledgeDetailID").value;
			HideShow();
		}
		createXMLHttp();
		var send_string="DoType=ChangeNote&KnowledgeNote="+escape(obj.value) + "&KnowledgeID=" + KnID;
		send_string= encodeURI(send_string);
		xmlHTTP.open("post","knowledge.asp",false); //传送方式 读取的页面 异步与否
		xmlHTTP.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); 
		xmlHTTP.send(send_string); //发送		
		//if(xmlHTTP.readystate==4)
//		{ // xmlHttp下的readystate方法 4表示传送完毕
//			if(xmlHTTP.status==200){ // xmlHttp的status方法读取状态（服务器HTTP状态码） 200对应OK 404对应Not Found（未找到）等
//				if (xmlHTTP.responseText != "")  {	alert(xmlHTTP.responseText);}
//			}	
//		}
	}
}
function ChangeKBg(obj)
{
	if ( obj.style.color == "#999999" ) { return;}
	obj.style.backgroundColor = "#0068b7";
	obj.style.color = "#FFFFFF";
	if ( obj.parentNode.id.indexOf("_") == -1) {$("KWindow_1").style.display = "none";}
}

function BackKBg(obj)
{
	if ( obj.style.color == "#999999" ) { return;}
	obj.style.backgroundColor = "#dce6ee";
	obj.style.color = "#0f3460";
}
function EditKnowledge(EType)
{
	AddType = EType;
	if ( EType == "Edit" )
	{		
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeName&KnowledgeID="+NowKnowledgeID,false);
		xmlhttp.send();		
		$("KnowledgeName").value = bytes2BSTR(xmlhttp.ResponseBody);
		$("KDetail").style.display = "block";
		var x=getX($("KnowledgeBuilding_Content"))+70;
		var y=getY($("KnowledgeBuilding_Content"))+70;
		$("KDetail").style.left = x;
		$("KDetail").style.top = y;
		$("KWindow").style.display = "none";
		$("KWindowz").style.display = "none"; 
		$("KWindow_1").style.display = "none";
		$("Over").style.height = document.body.offsetHeight;
		$("Over").style.display = "block";
		var MaxID = document.getElementsByTagName("select").length;
		for (i=0;i<MaxID;i++)
		{
			document.getElementsByTagName("select")[i].disabled = false;
		}
	}
	//if ( EType == "KeepDelete" )
//	{
//		if(window.confirm("确实要删除考点并把试题保留在上一级吗？")){
//			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
//			xmlhttp.open("GET","knowledge.asp?DoType=KeepDelKnowledge&KnowledgeID="+NowKnowledgeID,false);
//			xmlhttp.send();
//			var trname = "tr_" + NowKnowledgeID;
//			var nextname = "Next_" + NowKnowledgeID;
//			var obj = $(trname).parentNode.parentNode;
//			obj.deleteRow($(trname).rowIndex);
//			if ( $(nextname) )
//			{
//				obj.deleteRow($(nextname).rowIndex);
//			}		
//			if ( obj.rows.length == 0 )
//			{
//				obj.parentNode.parentNode.style.display = "none";
//			}	
//			var objid = obj.parentNode.parentNode.id;
//			objid = objid.substring(objid.indexOf("_")+1,objid.length);
//			ChangeNum(objid);	
//		}else{
//			return;
//		}
//	}
	if ( EType == "Delete" )
	{
		if(window.confirm('确实要删除吗？此选择将会删除该考点下的所有试题！')){
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","knowledge.asp?DoType=DelKnowledge&KnowledgeID="+NowKnowledgeID,false);
			xmlhttp.send();			
			var trname = "tr_" + NowKnowledgeID;
			var obj = $(trname).parentNode.parentNode;
			var nextname = "Next_" + NowKnowledgeID;
			if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
			{	
				alert(bytes2BSTR(xmlhttp.ResponseBody));
				if ( $(nextname) )
				{
					xmlhttp.open("GET","knowledge.asp?DoType=CallKnowledge&CourseID=2&KnowledgeID="+NowKnowledgeID,false);
					xmlhttp.send();
					$(nextname).cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
				}
				ChangeNum(NowKnowledgeID);				
			}
			else
			{
				if ( $(trname).cells[0].innerHTML.indexOf("·") < 0 )
				{
					obj.deleteRow($(trname).rowIndex+1);
				}
				obj.deleteRow($(trname).rowIndex);				
				if ( obj.rows.length == 0 && obj.id == "KB_0" )
				{
					obj.insertRow(0);
					obj = obj.rows[0];
					obj.id = "tr_0";					
					obj.attachEvent("onmouseover",function(){ChangeBg($(obj.id));});
					var KWindowName;
					KWindowName = "KWindow_0"; 
					obj.attachEvent("onmousedown",function(){ShowRight($(KWindowName),$(obj.id));});
					obj.attachEvent("onmouseout",function(){BackBg($(obj.id));});
					obj.insertCell(0);
					obj.cells[0].className = "td1";
					obj.cells[0].style.color = "#989898";
					obj.cells[0].innerHTML = '&nbsp;&nbsp;请利用右键完成考点设置和试题建设！';
					obj.insertCell(1);
					obj.cells[1].className = "td2";
					obj.cells[1].innerHTML = "&nbsp;";
				}
				else
				{					
					var objid;
					if ( obj.id != "KB_0")	{objid = obj.parentNode.parentNode.parentNode.id;}
					else {objid = obj.rows[0].id;}
					objid = objid.substring(objid.indexOf("_")+1,objid.length);
					ChangeNum(objid);	
					if ( obj.rows.length == 0 )
					{
						obj.parentNode.parentNode.parentNode.parentNode.deleteRow(obj.parentNode.parentNode.rowIndex);	
					}								
				}
			}		
		}else{
			return;
		}
	}
	if ( EType == "CopySelf" || EType == "CopyShare" )
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=" + EType + "&CourseID=2&KnowledgeID="+NowKnowledgeID,false);
		xmlhttp.send();
		var trname = "tr_" + NowKnowledgeID;
		var obj = $(trname).parentNode.parentNode.parentNode;		
		obj.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);		
		if ( $(trname).parentNode.parentNode.id == "KB_0" )
		{
			$("KB_0").className = "nonormal";
		}
		HideShow();
	}
}
function AddKnowledge(AType,SType)
{
	AddType = AType;
	if ( SType != null ) { ShareType = SType;}	
	$("KDetail").style.display = "block";
	var x=getX($("KnowledgeBuilding_Content"))+70;
	var y=getY($("KnowledgeBuilding_Content"))+70;
	$("KDetail").style.left = x;
	$("KDetail").style.top = y;
	$("KWindow").style.display = "none";
	$("KWindowz").style.display = "none";  
	$("KWindow_1").style.display = "none";
	$("KWindow_0").style.display = "none";
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = true;
	}
}
function AddFolder(AType,SType)
{
	AddType = AType;
	HideWindow();
	if ( SType != null ) { ShareType = SType;}	
	$("FDetail").style.display = "block";
	var x=getX($("KnowledgeBuilding_Content"))+270;
	var y=getY($("KnowledgeBuilding_Content"))+270;
	$("FDetail").style.left = x;
	$("FDetail").style.top = y;
	$("FWindow").style.display = "none";
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";
	
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = true;
	}
}
function EditFolder(AType)
{
	AddType = AType;
	if ( AType == "Edit" )
	{		
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=GetFolderName&SaveKindID="+SaveKindID,false);
		xmlhttp.send();		
		$("FolderName").value = bytes2BSTR(xmlhttp.ResponseBody);
		$("FDetail").style.display = "block";
		var x=getX($("KnowledgeBuilding_Content"))+270;
		var y=getY($("KnowledgeBuilding_Content"))+270;
		$("FDetail").style.left = x;
		$("FDetail").style.top = y;
		$("FWindow").style.display = "none";
		$("Over").style.height = document.body.offsetHeight;
		$("Over").style.display = "block";
		var MaxID = document.getElementsByTagName("select").length;
		for (i=0;i<MaxID;i++)
		{
			document.getElementsByTagName("select")[i].disabled = true;
		}
	}	
	if ( AType == "Delete" )
	{
		if(window.confirm('确实要删除吗？此选择将会删除该考点下的所有试题！')){
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=DelFolder&SaveKindID="+SaveKindID,false);
			xmlhttp.send();			
			var trname = "Foldertr_" + SaveKindID;
			var obj = $(trname).parentNode.parentNode;
			var nextname = "FolderNext_" + SaveKindID;			
			if ( $(nextname) )
			{
				obj.deleteRow($(trname).rowIndex+1);
			}
			obj.deleteRow($(trname).rowIndex);				
			if ( obj.rows.length == 0 && obj.id == "Folder_0" )
			{
				obj.insertRow(0);
				obj = obj.rows[0];
				obj.id = "Foldertr_0";					
				obj.attachEvent("onmouseover",function(){HideWindow();});
				obj.attachEvent("onmousedown",function(){ShowRight2('0');});
				obj.insertCell(0);
				obj.cells[0].className = "td3";
				obj.cells[0].style.color = "#989898";
				obj.cells[0].innerHTML = '&nbsp;&nbsp;请利用右键完成文件夹设置！';
			}				
		}else{
			return;
		}
		$("FWindow").style.display = "none";
	}
}
function SaveFolder()
{
	if ( $("FolderName").value == "" )
	{
		alert('请输入文件夹名称！')
		return false;
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=AddSaveKindFolder&AddType="+ AddType +"&SaveKindID="+SaveKindID+"&SaveKindName="+$("FolderName").value + "&CourseID=2&TestModelID=" + Library,false);
	xmlhttp.send();	
	if ( AddType == "Edit" )
	{
		var trname = "Foldertr_" + SaveKindID;
		obj = $(trname).cells[0];
		obj.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		HideShow();
		return;
	}	
	if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
	{
		var ReturnStr = bytes2BSTR(xmlhttp.ResponseBody);
		var KID = ReturnStr.split("|")[0];
		ReturnStr = ReturnStr.split("|")[1];		
		var trname;
		var obj;
		if ( AddType == "First" )
		{
			obj = $("Folder_0")
			if ( obj.rows[0].id == "Foldertr_0" )
			{
				obj.deleteRow(0);
				obj.insertRow(0);
				obj = obj.rows[0];
			}
			else
			{
				obj.insertRow(obj.rows.length);
				obj = obj.rows[obj.rows.length-1];
			}
			obj.id = "Foldertr_" + KID;			
			//obj.title = "鼠标左键拖动排序";			
			obj.attachEvent("onmouseover",function(){ChangeBg($(obj.id));});
			//obj.attachEvent("onmousedown",function(){;});		
			//obj.attachEvent("onmouseup",function(){TMoveRow($(obj.id));});
			obj.attachEvent("onmouseout",function(){BackBg($(obj.id));});
			obj.insertCell(0);
			obj.cells[0].className = "td3";
			obj.cells[0].innerHTML = ReturnStr;
			HideShow();
			return;
		}
		if ( AddType == "Same" )
		{
			trname = "Foldertr_" + SaveKindID;
			obj = $(trname).parentNode.parentNode;
		}
		else
		{
			trname = "Folder_" + SaveKindID;
			obj = $(trname);
			if ( !obj )
			{
				//var nextname = "FolderNext_" + SaveKindID;
//				var html;				
//				if ( $(nextname) )
//				{					
//					$(nextname).cells[0].innerHTML = "<table id='Folder_" + SaveKindID  + "' cellspacing='0' cellpadding='0'></table>"
//				}		
				trname = "Foldertr_" + SaveKindID;
				ShowFolder(SaveKindID,$(trname));
				HideShow();
				return;
			}
		}
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.id = "Foldertr_" + KID;			
		//obj.title = "鼠标左键拖动排序";
		obj.attachEvent("onmouseover",function(){HideWindow();});
		obj.attachEvent("onmousedown",function(){ShowRight3(KID);});
		obj.attachEvent("onclick",function(){ShowFolder(KID,$(obj.id));});		
//		obj.attachEvent("onmouseup",function(){TMoveRow($(obj.id));});
		//obj.attachEvent("onmouseout",function(){BackBg($(obj.id));});
		obj.insertCell(0);
		obj.cells[0].className = "td3";		
		obj.cells[0].innerHTML = ReturnStr;
		var obj1 = obj.parentNode.parentNode;
		obj1.insertRow(obj1.rows.length);
		obj1 = obj1.rows[obj1.rows.length-1];
		obj1.id = "FolderNext_" + KID;
		obj1.className = "next"
		obj1.insertCell(0);		
		obj1.cells[0].innerHTML = "";			
	}		
	HideShow();
}
function SaveKnowledge()
{
	if ( $("KnowledgeName").value == "" )
	{
		alert('请输入考点内容！')
		return false;
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=AddKnowledge&ShareType="+ ShareType +"&AddType="+ AddType +"&KnowledgeID="+NowKnowledgeID+"&KnowledgeName="+$("KnowledgeName").value + "&CourseID=2",false);
	xmlhttp.send();	
	if ( AddType == "Edit" )
	{
		var trname = "tr_" + NowKnowledgeID;
		obj = $(trname).cells[0].firstChild;
		obj.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		HideShow();
		return;
	}
	if ( ShareType != null && !$(ShareType).checked) { return false;}	
	if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
	{
		var ReturnStr = bytes2BSTR(xmlhttp.ResponseBody);
		var KID = ReturnStr.substring(0,ReturnStr.indexOf(","));
		var Num = parseInt(ReturnStr.substring(ReturnStr.indexOf(",")+1,ReturnStr.length))-23;
		var trname;
		var obj;
		if ( AddType == "First" )
		{
			obj = $("KB_0")
			if ( obj.rows[0].id == "tr_0" )
			{
				obj.deleteRow(0);
				obj.insertRow(0);
				obj = obj.rows[0];
			}
			else
			{
				obj.insertRow(obj.rows.length);
				obj = obj.rows[obj.rows.length-1];
			}
			obj.id = "tr_" + KID;			
			//obj.title = "鼠标左键拖动排序";			
			obj.attachEvent("onmouseover",function(){ChangeBg($(obj.id));});
			var KWindowName;
			if ( ShareType == "Self" ) { KWindowName = "KWindowz";}
			else { KWindowName = "KWindow"; }
			obj.attachEvent("onmousedown",function(){ShowRight($(KWindowName),$(obj.id),ShareType);});		
			obj.attachEvent("onmouseup",function(){TMoveRow($(obj.id));});
			obj.attachEvent("onmouseout",function(){BackBg($(obj.id));});
			obj.insertCell(0);
			obj.cells[0].className = "td1";
			if ( ShareType == "Self" )
			{
				Num = parseInt(Num) - 13;
				obj.cells[0].innerHTML = "<div style='margin-left:"+ Num +"px;' class='Ktitlez1'><img src='images/self.png' />·" + $("KnowledgeName").value + "【<a href='javascript:WinOpen("+KID+");'>0</a>】</div>";
			}
			else
			{
				obj.cells[0].innerHTML = "<div style='margin-left:"+ Num +"px;' class='Ktitle1'>·" + $("KnowledgeName").value + "【<a href='javascript:WinOpen("+KID+");'>0</a>】</div>";
			}
			obj.insertCell(1);
			obj.cells[1].className = "td2";
			obj.cells[1].innerHTML = "<input id='I_" + KID +"' onBlur='ChangeNote(this)' class='insert' type='text' />";
			HideShow();
			return;
		}
		if ( AddType == "Same" )
		{
			trname = "tr_" + NowKnowledgeID;
			obj = $(trname).parentNode.parentNode;
		}
		else
		{
			trname = "KB_" + NowKnowledgeID;
			obj = $(trname);
			if ( !obj )
			{
				var nextname = "Next_" + NowKnowledgeID;
				var html;				
				if ( !$(nextname) )
				{					
					trname = "tr_" + NowKnowledgeID;
					$(trname).attachEvent("onmousedown",function(){ShowNext(NowKnowledgeID,2);});
					html = $(trname).cells[0].innerHTML;
					if ( html.indexOf("self") >= 0 || html.indexOf("fopens") >= 0 || html.indexOf("fcloses") >= 0 )
					{
						Num = parseInt(Num) - 23;
						$(trname).cells[0].innerHTML = "<div style='margin-left:" + Num  + "px;' class='Ktitle'><img id='img_" + NowKnowledgeID + "' src='images/new/fopens.gif' />&nbsp;" + html.substring(html.indexOf("·")+1,html.length);
					}
					else
					{
						Num = parseInt(Num) - 23;
						$(trname).cells[0].innerHTML = "<div style='margin-left:" + Num + "px;' class='Ktitle'><img id='img_" + NowKnowledgeID + "' src='images/new/fopen.gif' />&nbsp;" + html.substring(html.indexOf("·")+1,html.length);
					}
					obj = $(trname).parentNode.parentNode;
					obj.insertRow($(trname).rowIndex+1);
					obj = obj.rows[$(trname).rowIndex+1];
					obj.id = "Next_" + NowKnowledgeID;
					obj.className = "next"
					obj.insertCell(0);
					obj.cells[0].colSpan = 2;
				}				
				ShowNext(NowKnowledgeID,2);
				HideShow();
				return;
			}
		}
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.id = "tr_" + KID;			
		//obj.title = "鼠标左键拖动排序";			
		obj.attachEvent("onmouseover",function(){ChangeBg($(obj.id));});
		var KWindowName;
		if ( ShareType == "Self" ) { KWindowName = "KWindowz";}
		else { KWindowName = "KWindow"; }
		obj.attachEvent("onmousedown",function(){ShowRight($(KWindowName),$(obj.id),ShareType);});		
		obj.attachEvent("onmouseup",function(){TMoveRow($(obj.id));});
		obj.attachEvent("onmouseout",function(){BackBg($(obj.id));});
		obj.insertCell(0);
		obj.cells[0].className = "td1";		
		if ( ShareType == "Self" )
		{
			Num = parseInt(Num) - 13;
			obj.cells[0].innerHTML = "<div style='margin-left:"+ Num +"px;' class='Ktitlez1'><img src='images/self.png' />·" + $("KnowledgeName").value + "【<a href='javascript:WinOpen("+KID+");'>0</a>】</div>";
		}
		else
		{
			if ( parseInt(TestLibraryLimit) == "1" )
			{
				obj.cells[0].innerHTML = "<div style='margin-left:"+ Num +"px;' class='Ktitle1'>·" + $("KnowledgeName").value + "【<a href='javascript:WinOpen("+KID+");'>0</a>】<span class='red'>(待审核)</span><div>";
			}
			else
			{
				obj.cells[0].innerHTML = "<div style='margin-left:"+ Num +"px;' class='Ktitle1'>·" + $("KnowledgeName").value + "【<a href='javascript:WinOpen("+KID+");'>0</a>】<span class='red'>(待审核)</span><div>";
			}
		}	
		obj.insertCell(1);
		obj.cells[1].className = "td2";
		obj.cells[1].innerHTML = "<input id='I_" + KID +"' onBlur='ChangeNote(this)' class='insert' type='text' />";		
	}		
	HideShow();
}
function HideShow()
{
	$("KnowledgeName").value = "";
	$("SaveKindName").value = "";
	$("KDetail").style.display = "none";
	$("SearchNote").style.display = "none";
	$("SaveName").style.display = "none";
	$("FDetail").style.display = "none";
	$("Over").style.display = "none";
	$("TitleDetail").style.display = "none";
	$("KWindow_0").style.display = "none";
	$("KWindow").style.display = "none"; 
	$("KWindowz").style.display = "none";
	$("KWindow_1").style.display = "none";
	$("KnowledgeDetail").style.display = "none";	
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = false;
	}
}
function ChangeWidth(obj)
{
	if ( obj.id=="WidthImg" )
	{
		if ( obj.src.indexOf("right") > 0 )
		{
			obj.src = "images/ktopleft.gif";
			obj.parentNode.nextSibling.width = "606";	
			$("KB_0").className = "nonormal";	
		}
		else
		{
			obj.src = "images/ktopright.gif";
			obj.parentNode.nextSibling.width = "537";
			$("KB_0").className = "normal";	
		}
	}
	else
	{
		if ( obj.src.indexOf("right") > 0 )
		{
			obj.src = "images/ktopleft.gif";
			$("LibraryList").style.width = "377px";
			$("KBuilding").style.width = "606px";
		}
		else
		{
			obj.src = "images/ktopright.gif";			
			$("LibraryList").style.width = "447px";
			$("KBuilding").style.width = "530px";
		}
	}
}
function ShowTitleType()
{
	$("StyleWindow").style.display = "block";
	$("Over").style.display = "block";
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=CallTitleType",false);
	xmlhttp.send();				
	$("List2").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);	
}
var TitleTypeID,TitleTypeType;
function ExitTitleType()
{
	$("TitleType").style.display = "none";
	$("StyleWindow").style.display = "block";
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=CallTitleType",false);
	xmlhttp.send();				
	$("List2").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);	
}
function SaveTitleType()
{
	if ( $("TitleTypeName").value != "" )
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=EditTitleType&Type="+TitleTypeType+"&TitleTypeID="+TitleTypeID+"&TitleTypeName="+$("TitleTypeName").value+"&BaseTitleType="+$("BaseTitleType").value+"&OptionsNum="+$("OptionsNum").value+"&AnswerNum="+$("AnswerNum").value,false);
		xmlhttp.send();	
		$("TitleType").style.display = "none";
		$("StyleWindow").style.display = "block";		
		xmlhttp.open("GET","knowledge.asp?DoType=CallTitleType",false);
		xmlhttp.send();				
		$("List2").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);	
	}
	else
	{
		alert('请输入有效的名称！');
	}
}
function ShowBase(obj)
{
	if ( obj.value == "1" )
	{
		obj = obj.parentNode.parentNode;
		obj.childNodes[4].style.display = "block";
		obj.childNodes[5].style.display = "block";
		obj.childNodes[6].style.display = "block";
		obj.childNodes[7].style.display = "block";
	}
	else
	{
		obj = obj.parentNode.parentNode;
		obj.childNodes[4].style.display = "none";
		obj.childNodes[5].style.display = "none";
		obj.childNodes[6].style.display = "none";
		obj.childNodes[7].style.display = "none";;
	}
}
function TitleType(Type,TTID)
{
	if ( Type == 'Delete' )
	{
		if(window.confirm('确实要删除该类型嘛？'))
		{
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","knowledge.asp?DoType=DelTitleType&TitleTypeID="+TTID,false);
			xmlhttp.send();
			alert(bytes2BSTR(xmlhttp.ResponseBody));
		}
	}
	if ( Type == 'Add' || Type == 'Edit' )
	{
		$("StyleWindow").style.display = "none";
		$("TitleType").style.display = "block";
		$("TitleType").style.left = 250;
		$("TitleType").style.top = 250;
		TitleTypeID = TTID;
		TitleTypeType = Type;
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		if ( TTID != null )
		{
			xmlhttp.open("GET","knowledge.asp?DoType=GetTitleType&TitleTypeID="+TTID,false);
		}
		else
		{
			xmlhttp.open("GET","knowledge.asp?DoType=GetTitleType",false);
		}
		xmlhttp.send();		
		if ( Type == 'Add')
		{
			$("TitleType").childNodes[0].childNodes[0].innerHTML = '题型添加';
		}
		else
		{
			$("TitleType").childNodes[0].childNodes[0].innerHTML = '题型管理';
		}
		$("TitleType").childNodes[1].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	}
	
}
var CTime;
var rownum=0;
var nownum=0;
function ShowInnerHTML()
{
	if (nownum<$("KB_0").rows.length)
	{
		if ($("KB_0").rows[nownum].id.indexOf("tr") >= 0 )
		{				
			var KID = $("KB_0").rows[nownum].id.substring(3,$("KB_0").rows[nownum].id.length);
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=GetKnowledgeInnerHTML&KnowledgeID="+KID,false);
			xmlhttp.send();		
			$("KB_0").rows[nownum].cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody).split("|SY|")[0];
			$("KB_0").rows[nownum].cells[1].innerHTML = bytes2BSTR(xmlhttp.ResponseBody).split("|SY|")[1];	
		}
	}
	else
	{
		clearInterval(CTime);
	}
	nownum++;
}
var KnowledgeTableName = "SY_QBKnowledges";
function OpenAuto(OpenType,SKID)
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=GetAutoSaveKindID&SaveKindID="+SKID,false);
	xmlhttp.send();	
	if (OpenType == "Paper")
	{
		OpenPaper(bytes2BSTR(xmlhttp.ResponseBody));
	}
	else
	{
		SaveKindID = bytes2BSTR(xmlhttp.ResponseBody);
		ChangeButton($("banner").childNodes[0],"stzj");
	}
}
function ChangeButton(obj,text)
{	
	for ( i=0; i<$("banner").childNodes.length; i++)
	{
		$("banner").childNodes[i].className = "bbutton";
	}
	obj.className = "bbuttonc";
	var obuttontype = ButtonType;
	ButtonType = text;
	type = '';
	if ( text == "kdsz")
	{
		KnowledgeTableName = "SY_QBKnowledges";
		$("Knowledge").style.display = "block";
		$("LibraryList").style.display = "none";		
		$("KBuilding").style.display = "none";		
		$("WidthImg").style.display = "block";
		$("Library_S").style.display = "none";
		//$("TestTemple").style.display = "none";
		$("WidthImg").src = "images/ktopleft.gif";
		$("WidthImg").parentNode.nextSibling.width = "600";
		$("KB_0").className = "nonormal";
		$("TableName").style.textAlign = "center";
		$("TableName").style.fontSize = "14px";
		$("TableName").style.fontWeight = "bold";
		$("TableName").innerHTML = '考点简介';
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");			
		xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=CallKnowledge&KnowledgeID=0&CourseID=2",false);
		xmlhttp.send();	
		if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
		{				
			$("KnowledgeBuilding_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}
		$("KB_0").className = "nonormal";
		//CTime=setInterval(ShowInnerHTML,10);
//		rownum=0;
//  		nownum=0;
		return;
	}
	if ( text == "zsdjs")
	{
		KnowledgeTableName = "SY_QBKnowledge";
		$("Knowledge").style.display = "none";		
		$("LibraryList").style.display = "block";		
		$("KBuilding").style.display = "block";
		$("KnowledgeTemple").style.display = "block";
		$("KnowledgeBuilding").style.display = "block";
		$("Library_S").style.display = "none";
		$("Library").style.display = "none";
		//$("TestTemple").style.display = "none";
		$("KnowledgeBuilding_Content").innerHTML = "";
		$("KnowledgeBuilding").childNodes[0].childNodes[0].style.display = "none";
		$("KnowledgeBuilding").childNodes[0].childNodes[1].innerHTML = '知识点名称';
		$("LibraryList").style.width = "377px";
		$("KBuilding").style.width = "600px";
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");			
		xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=CallKnowledge&KnowledgeID=0&CourseID=2&KnowledgeTableName="+KnowledgeTableName,false);
		xmlhttp.send();	
		$("KnowledgeBuilding_Content1").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);	
		return;
	}
	if ( text == "kdjs")
	{
		KnowledgeTableName = "SY_QBKnowledges";
		$("Knowledge").style.display = "block";
		$("LibraryList").style.display = "none";		
		$("KBuilding").style.display = "none";	
		$("WidthImg").style.display = "block";
		$("Library_S").style.display = "none";
		$("WidthImg").src = "images/ktopleft.gif";
		//$("TestTemple").style.display = "none";
		$("WidthImg").parentNode.nextSibling.width = "600";		
		$("TableName").style.textAlign = "left";		
		$("TableName").style.fontSize = "12px";
		$("TableName").style.fontWeight = "100";		
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=ShowTitleType",false);
		xmlhttp.send();
		$("TableName").innerHTML = bytes2BSTR(xmlhttp.ResponseBody) + "<span style='float:right;font-weight:100;font-size:12px;'><a href='javascript:void(0)' onclick='ShowTitleType()'>题型管理</a></span>";		
		xmlhttp.open("GET","knowledge.asp?ButtonType=" + ButtonType + "&DoType=CallKnowledge&KnowledgeID=0&CourseID=2",false);
		xmlhttp.send();	
		if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
		{				
			$("KnowledgeBuilding_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}
		$("KB_0").className = "nonormal";
		var obj =$("KnowledgeBuilding_Content1").childNodes[0];
		for (i=0;i<obj.rows.length;i++)
		{
			if ( obj.rows[i].id.indexOf("tr_") >=0 )
			{
				$("KB_0").rows[i].cells[0].childNodes[0].innerHTML = obj.rows[i].cells[0].childNodes[0].innerHTML.replace("fclose","fopen");
				
			}
		}
		CTime=setInterval(ShowInnerHTML,10);
		rownum=0;
  		nownum=0;		
		return;
	}
	if ( text == "stzj")
	{
		KnowledgeTableName = "SY_QBKnowledges";
		$("Knowledge").style.display = "none";		
		$("LibraryList").style.display = "block";		
		$("KBuilding").style.display = "block";
		$("KnowledgeTemple").style.display = "block";
		$("KnowledgeBuilding").style.display = "block";
		$("Library_S").style.display = "none";
		$("Library").style.display = "none";
		$("KnowledgeBuilding_Content").innerHTML = "";
		$("LibraryList").style.width = "377px";
		//$("TestTemple").style.display = "none";
		$("KBuilding").style.width = "600px";
		$("KnowledgeBuilding").childNodes[0].childNodes[0].style.display = "block";
		if ((parseInt(4)==4 || parseInt(4)==5) && obuttontype == "gxsj" )
		{
			ShowKnowledge(SaveKindID);
		}	
		else
		{
			$("KnowledgeBuilding").childNodes[0].childNodes[1].innerHTML = '考点名称';	
		}
		return;
	}
	if ( text == "zxzj")
	{
		KnowledgeTableName = "SY_QBKnowledges";
		$("Knowledge").style.display = "none";		
		$("LibraryList").style.display = "block";		
		$("KBuilding").style.display = "block";
		$("KnowledgeTemple").style.display = "none";
		//$("TestTemple").style.display = "block";
		$("KnowledgeBuilding").style.display = "block";
		$("Library_S").style.display = "none";
		$("Library").style.display = "none";
		$("KnowledgeBuilding_Content").innerHTML = "";
		$("LibraryList").style.width = "377px";
		$("KBuilding").style.width = "600px";
		$("KnowledgeBuilding").childNodes[0].childNodes[0].style.display = "block";
		$("KnowledgeBuilding").childNodes[0].childNodes[1].innerHTML = '考点名称';
		for ( i=0;i<$("KB_0").rows.length;i++)
		{
			if ($("KB_0").rows[i].className != "next")
			{
				$("KB_0").rows[i].cells[1].style.display = "none";
			}
		}
		return;
	}
	if ( text == "sjgl")
	{
		$("Knowledge").childNodes[1].innerHTML = "";
		$("Knowledge").style.display = "none";		
		$("LibraryList").style.display = "block";
		$("KnowledgeBuilding").style.display = "none";
		$("KBuilding").style.display = "block";
		//$("TestTemple").style.display = "none";
		$("KnowledgeTemple").style.display = "block";
		$("Library").style.display = "block";
		$("Library_S").style.display = "none";
		$("LibraryList").style.width = "377px";
		$("KBuilding").style.width = "600px";
		
		DelAllTable(2);
		if ( $("Library_Content").innerHTML == "" )
		{	
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID=0&TestModelID="+Library,false);
			xmlhttp.send();
			$("Library_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}	
		if ((parseInt(4)==4 || parseInt(4)==5) && obuttontype == "gxsj" )
		{
			if (parseInt(SaveKindID)>0)
			{
				ShowKnowledge(SaveKindID);
			}
		}
		return;
	}
	if ( text == "gxsj" && parseInt(4) != 4 )
	{
		$("Knowledge").childNodes[1].innerHTML = "";
		$("Knowledge").style.display = "none";		
		$("LibraryList").style.display = "block";
		$("KnowledgeBuilding").style.display = "none";
		$("KBuilding").style.display = "block";
		$("KnowledgeTemple").style.display = "none";
		$("Library").style.display = "block";
		$("Library_S").style.display = "block";
		//$("TestTemple").style.display = "none";
		$("LibraryList").style.width = "447px";
		$("KBuilding").style.width = "530px";
		type = 'Share'
		DelAllTable(2);
		if ( $("Library_Content").innerHTML == "" )
		{	
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID=0&TestModelID="+Library,false);
			xmlhttp.send();
			$("Library_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}
		if ( $("Library_S_Content").innerHTML == "" )
		{	
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID=0&TestModelID="+Library,false);
			xmlhttp.send();
			//alert(bytes2BSTR(xmlhttp.ResponseBody));
			$("Library_S_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}		
		return;
	}
	if ( text == "gxsj" && parseInt(4) == 4 )
	{
		
		$("KBuilding").style.display = "block";
		$("KnowledgeTemple").style.display = "none";
		//$("Library").style.display = "block";
		$("Library_S").style.display = "block";
		//$("TestTemple").style.display = "none";
		$("LibraryList").style.width = "447px";
		$("KBuilding").style.width = "530px";
		type = 'Share'
		DelAllTable(2);		
		if ( $("Library_S_Content").innerHTML == "" )
		{	
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID=0&TestModelID="+Library,false);
			xmlhttp.send();
			//alert(bytes2BSTR(xmlhttp.ResponseBody));
			$("Library_S_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		}		
		return;
	}
}
function Choose(TitleInforID)
{
	obj = $("TModels");
	if ( obj.rows[0].cells[0].colSpan == 4 && obj.rows[0].id == "" )
	{
		obj.deleteRow(0);
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=CallTitleInfor&TitleInforID="+TitleInforID,false);
	xmlhttp.send();
	var str = bytes2BSTR(xmlhttp.ResponseBody).split("[#SY#]");
	obj.insertRow(obj.rows.length);
	obj = obj.rows[obj.rows.length-1];
	obj.id = TitleInforID;			
	obj.attachEvent("onmouseover",function(){HideWindow();});
	obj.attachEvent("onmousedown",function(){ShowRight4($("TWindow1"),obj);});
	obj.insertCell(0);
	obj.cells[0].className = "td6";
	obj.cells[0].style.width = "70%";
	obj.cells[0].style.borderBottom = "1px solid #9bc6fd";
	obj.cells[0].style.borderRight = "1px solid #9bc6fd";
	obj.cells[0].innerHTML = str[0];
	SYLatexEngine.RenderNode(obj.cells[0]);
	obj.insertCell(1);
	obj.cells[1].className = "td5";
	obj.cells[1].style.width = "10%";	
	obj.cells[1].style.borderBottom = "1px solid #9bc6fd";
	obj.cells[1].style.borderRight = "1px solid #9bc6fd";
	obj.cells[1].innerHTML = str[1];
	obj.insertCell(2);
	obj.cells[2].className = "td5";
	obj.cells[2].style.width = "10%";
	obj.cells[2].style.borderBottom = "1px solid #9bc6fd";
	obj.cells[2].style.borderRight = "1px solid #9bc6fd";
	switch(parseInt(str[2]))
	{
		case 1:
			obj.cells[2].innerHTML = '易';
			break;
		case 2:
			obj.cells[2].innerHTML = '中下';
			break;
		case 3:
			obj.cells[2].innerHTML = '中';
			break;
		case 4:
			obj.cells[2].innerHTML = '中上';
			break;
		case 5:
			obj.cells[2].innerHTML = '难';
			break;		
	}
	obj.insertCell(3);
	obj.cells[3].className = "td5";
	obj.cells[3].style.width = "10%";
	obj.cells[3].style.borderBottom = "1px solid #9bc6fd";
	obj.cells[3].innerHTML = "<input id='TTitleScroe' name='TTitleScroe' onchange='ChangeScroe();' value ='1' size='2' />";	
	$("TExamNum").innerHTML = parseInt($("TExamNum").innerHTML) + 1;
	$("TTotalNum").innerHTML = parseInt($("TTotalNum").innerHTML) + 1;
	getTLevel();
}
function WinOpen(KnowledgeID,TitleTypeID)
{
	if ( TitleTypeID == null )
	{
		window.open('examlist.asp?KnowledgeID='+KnowledgeID+'&ButtonType='+ButtonType);
	}
	else
	{
		window.open('examlist.asp?KnowledgeID='+KnowledgeID+'&TitleTypeID='+TitleTypeID+'&ButtonType='+ButtonType);
	}
}
function ShowRight4(WinName,obj)
{
	if((parseInt(window.event.button)%2) ==0)
	{
		WinName.style.display = "block";
		var x=document.documentElement.scrollLeft + event.x;
        var y= event.y;	
		if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   {
			  y = document.documentElement.scrollTop + y;
	   }
		WinName.style.left = x;
		WinName.style.top = y;		
		NowKnowledgeID = obj.id;
	}	
}
function ShowRight1(WinName,obj)
{
	if((parseInt(window.event.button)%2) ==0)
	{
		WinName.style.display = "block";
		var x=document.documentElement.scrollLeft + event.x;
        var y= event.y;	
		if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   {
			  y = document.documentElement.scrollTop + y;
	   }
		WinName.style.left = x;
		WinName.style.top = y;
		if ( WinName.id == "AddTitle" ) { return;}
		if ( WinName.id == "TWindow" )
		{
			NowKnowledgeID = obj.id;
			return;
		}
		NowKnowledgeID = parseInt(obj.id.split("_")[0]);		
		NowName = obj.id;
		switch(obj.cells[2].innerHTML)
		{
			case '易':
				$("LevelID").options[0].selected = true;
				break;
			case '中下':
				$("LevelID").options[1].selected = true;
				break;
			case '中':
				$("LevelID").options[2].selected = true;
				break;
			case '中上':
				$("LevelID").options[3].selected = true;
				break;
			case '难':
				$("LevelID").options[4].selected = true;
				break;
		}
		$("TitleTypeID").options[parseInt(obj.id.split("_")[2])].selected = true;
	}
	else
	{
		if ( WinName.id == "AddTitle" ) { WinName.style.display = "none";}
		if ( obj == null ){ return;}
		if ( obj.parentNode.parentNode )
		{
			MoveTable = obj.parentNode.parentNode;
			MoveRow = obj;
			onMouseDown = true;
			$("KnowledgeTemple_Content_1").style.cursor = "move";
		}
	}
}
function ShowK(KID)
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeNote&KnowledgeID="+KID,false);
	xmlhttp.send();
	if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
	{
		WinName = $("ShowK");
		SYLatexEngine.RenderNode(WinName,{});
		WinName.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
		WinName.style.display = "block";
		var x=document.documentElement.scrollLeft + event.x;
		var y= event.y;	
		if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   {
			  y = document.documentElement.scrollTop + y;
	   }
		WinName.style.left = x;
		if ( y > 500 )
		{
			y= y - WinName.offsetHeight;
		}
		WinName.style.top = y;
	}
}
function ShowKnowledgeDetail(KID)
{
	$("Over").style.display = "block";
	$("KnowledgeDetail").style.display = "block";
	var x=getX($("KnowledgeTemple_Content"));
	var y=getY($("KnowledgeTemple_Content"));
	$("KnowledgeDetail").style.left = x;
	$("KnowledgeDetail").style.top = y;
	$("KnowledgeDetailID").value = KID;
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeName&KnowledgeID="+KID,false);
	xmlhttp.send();
	$("KnowledgeDetail").childNodes[0].childNodes[0].childNodes[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	xmlhttp.open("GET","knowledge.asp?DoType=GetKnowledgeNote&KnowledgeID="+KID,false);
	xmlhttp.send();
	$("KnowledgeDetailEdit").value = bytes2BSTR(xmlhttp.ResponseBody);
	$("eWebEditor").src="../SYEditor/SYEditor.htm?id=KnowledgeDetailEdit&style=bbs";
}
function ShowTitleWindow(showtype)
{
	AddType = showtype
	$("AddTitle").style.display = "none";
	$("Over").style.display = "block";
	$("TitleDetail").style.display = "block";
	if ( $("Library").style.display == "block" )
	{
		$("banner").childNodes[3].className = "bbutton";
		$("banner").childNodes[2].className = "bbuttonc";
		$("KnowledgeBuilding").style.display = "block";
		$("Library").style.display = "none";
	}
	var x=getX($("KnowledgeTemple_Content"))+70;
	var y=getY($("KnowledgeTemple_Content"))+70;
	$("TitleDetail").style.left = x;
	$("TitleDetail").style.top = y;
	$("Title").value = "";
	if ( showtype == "Edit" )
	{
		var obj = $("KModels");
		obj = $(NowKnowledgeID);
		$("Title").value=obj.cells[0].innerHTML;		
	}
}
function HideWindow()
{
	$("MWindow").style.display = "none";
	$("TWindow").style.display = "none";
	$("TWindow1").style.display = "none";
	$("AddTitle").style.display = "none";
	$("Window").style.display = "none";
	$("Over").style.display = "none";
	//$("FolderDetail").style.display = "none";
	$("Over").style.display = "none";
	$("ModelWindow1").style.display = "none";
	$("ModelWindow2").style.display = "none";
	$("FWindow").style.display = "none";
	$("FWindow0").style.display = "none";
	$("StyleWindow").style.display = "none";
//	$("SetFile").style.backgroundImage = "";
//	$("FolderList").style.display = "none";
//	$("SearchNote").style.display = "none";
//	$("SearchList").style.display = "none";
//	CType = "";
//	$("SelectWindow").style.display = "none";
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = false;
	}
}
function SaveTitleName(savetype)
{
	if ( savetype != null ) { AddType=savetype;}
	var obj;
	var cols=0;
	if ( $("Title").value == "" ) { alert('题目不能为空！请重新填写');return;}
		obj = $("KModels");
		cols=5;
	
	if ( AddType == "Add" )
	{
		if ( obj.rows[0].cells[0].colSpan == cols && obj.rows[0].id == "" )
		{
			obj.deleteRow(0);
		}		
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.id = obj.parentNode.rows.length-1;			
		obj.attachEvent("onmouseover",function(){HideWindow();});
		obj.attachEvent("onmousedown",function(){ShowRight1($("TWindow"),obj);});
		obj.attachEvent("onmouseup",function(){TMoveRow1(obj);});
		obj.insertCell(0);
		obj.cells[0].className = "mtitle";
		obj.cells[0].colSpan = cols
		//if ( $("TestTemple").style.display != "none" )
//		{
//			obj.cells[0].style.borderBottom = "1px solid #9bc6fd";
//		}
		obj.cells[0].innerHTML = $("Title").value;
	}
	if ( AddType == "Edit" )
	{
		obj = obj.rows[parseInt(NowKnowledgeID)];
		obj.cells[0].innerHTML = $("Title").value;
	} 
	if ( AddType == "Del" )
	{
		obj.deleteRow($(NowKnowledgeID).rowIndex);
		if ( obj.rows.length == 0 )
		{
			obj.insertRow(obj.rows.length);
			obj = obj.rows[obj.rows.length-1];
			obj.insertCell(0);
			obj.cells[0].colSpan = cols;
			obj.cells[0].className = "norecord";
			obj.cells[0].innerHTML = '通过考点建设栏目右侧的“选题”按钮即可进行考点选择!右键可添加题目！';
			//if ( $("TestTemple").style.display == "none" )
//			{
//				$("KExamNum").innerHTML = "0";
//				$("KTotalNum").innerHTML = "0";
//				$("KLevel").innerHTML = "0";
//				$("KModels_Result").rows[0].cells[0].innerHTML = "<span class='bold'>统计：</span>";
//			}
//			else
//			{
				$("TExamNum").innerHTML = "0";
				$("TTotalNum").innerHTML = "0";
				$("TLevel").innerHTML = "0";
				$("TestResult").rows[0].cells[0].innerHTML = "<span class='bold'>统计：</span>";

			//}
		}
	}
	$("TitleDetail").style.display = "none";
	$("Over").style.display = "none";
}
function SelTitleAreaShow(tag,KnowledgeID){
	if(tag==0)
	{
		$('SelTitleArea').style.display = 'none';
		$("Over").style.display = "none";
		var MaxID = document.getElementsByTagName("select").length;
		for (i=0;i<MaxID;i++)
		{
			document.getElementsByTagName("select")[i].disabled = false;
		}
	}
	else
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=Check&KnowledgeID="+KnowledgeID,false);
		xmlhttp.send();
		if ( bytes2BSTR(xmlhttp.ResponseBody) == "NO" )
		{
			alert('请先将该考点中的试题分配至底层各考点中！')
			return false;
		}
		NowKnowledgeID = KnowledgeID;	
		var x=getX($("KnowledgeBuilding_Content"));
		var y=getY($("KnowledgeBuilding_Content"));
		$("SelTitleArea").style.left = x+150;
		$("SelTitleArea").style.top = y+250;
		$('SelTitleArea').style.display = 'block';
		if ( $("Library").style.display == "block" )
		{
			$("banner").childNodes[3].className = "bbutton";
			$("banner").childNodes[2].className = "bbuttonc";
			$("KnowledgeBuilding").style.display = "block";
			$("Library").style.display = "none";
		}
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","knowledge.asp?DoType=GetPostion&KnowledgeID="+KnowledgeID,false);
		xmlhttp.send();
		$("SelTitleArea").childNodes[0].childNodes[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);	
		ShowTitleNum();	
		HideWindow();	
		$("Over").style.height = document.body.offsetHeight;
		$("Over").style.display = "block";
		var MaxID = document.getElementsByTagName("select").length;
		for (i=0;i<MaxID;i++)
		{
			if ( document.getElementsByTagName("select")[i].id != "LevelID" && document.getElementsByTagName("select")[i].id != "SelectTitleNum" && document.getElementsByTagName("select")[i].id != "TitleScroe" && document.getElementsByTagName("select")[i].id != "TitleTypeID")
			{
				document.getElementsByTagName("select")[i].disabled = true;
			}
		}
	}
}
function ShowTitleNum()
{
	var sql = "";
	//if ( $("AreaAll") )
	//{
	//	if ( $("AreaG").checked == true && $("AreaM").checked == true )
	//	{
	//		sql = " And (Notes like '%模拟%' Or Notes like '%高考%' ) ";
	//	}
	//	else
	//	{
	//		if ( $("AreaAll").checked == false )
	//		{
	//			if ( $("AreaG").checked == true )
	//			{
	//				sql = " And Notes like '%高考%' ";
	//			}
	//			if ( $("AreaM").checked == true )
	//			{
	//				sql = " And Notes like '%模拟%' ";
	//			}
	//		}
	//	}
	//}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=GetSelectTitleNum&KnowledgeID="+NowKnowledgeID+"&LevelID="+$("LevelID").value+"&TitleTypeID="+$("TitleTypeID").value + "&SQL="+escape(sql),false);
	xmlhttp.send();
	//alert(bytes2BSTR(xmlhttp.ResponseBody));
	$("ShowSelectTitleNum").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	xmlhttp.open("GET","knowledge.asp?DoType=GetAllTitleNum&KnowledgeID="+NowKnowledgeID+"&TitleTypeID="+$("TitleTypeID").value+ "&SQL="+escape(sql),false);
	xmlhttp.send();	
	$("TitleNumShow").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	var KName = NowKnowledgeID + "_" + $("LevelID").options[parseInt($("LevelID").value)-1].text;
	var obj = $(KName);
	if (obj)
	{		
		$("SelectTitleNum").options[parseInt(obj.cells[2].innerHTML)-1].selected = true;
		$("TitleScroe").value = obj.cells[3].innerHTML/obj.cells[2].innerHTML;
		//$("TitleScroe").options[parseInt(obj.cells[3].innerHTML)/parseInt(obj.cells[2].innerHTML)-1].selected = true;
	}
}
function getTLevel()
{
	var Total = 0;
	var obj = $("TModels");
	if (obj.rows[0].cells[0].colSpan == 4 && obj.rows[0].id == "" ) { $("KLevel").innerHTML = "0";return;}
	for ( i = 0; i < obj.rows.length; i++)
	{
		if ( obj.rows[i].cells[0].colSpan != 4 )
		{ 
			var Obj = obj.rows[i];
			var ObjLevel;
			switch(Obj.cells[2].innerHTML)
			{
				case '易':
					ObjLevel = 0.1;
					break;
				case '中下':
					ObjLevel = 0.3;
					break;
				case '中':
					ObjLevel = 0.5;
					break;
				case '中上':
					ObjLevel = 0.7;
					break;
				case '难':
					ObjLevel = 0.9;
					break;
			}
			Total = Total + ObjLevel;
		}
	}	
	Total = Total / parseInt($("TTotalNum").innerHTML);	
	$("TLevel").innerHTML = Total.toFixed(2);
}
function ChangeScroe()
{
	var Total = 0;
	for ( i = 0; i < $("TTitleScroe").length; i++)
	{
		Total = Total + $("TTitleScroe")[i].value;
	}
	$("TTotalNum").innerHTML = Total;
}
function getLevel()
{
	var Total = 0;
	var obj = $("KModels");
	if (obj.rows[0].cells[0].colSpan == 5 && obj.rows[0].id == "" ) { $("KLevel").innerHTML = "0";return;}
	for ( i = 0; i < obj.rows.length; i++)
	{
		if ( obj.rows[i].cells[0].colSpan != 5 )
		{ 
			var Obj = obj.rows[i];
			var ObjLevel;
			switch(Obj.cells[2].innerHTML)
			{
				case '易':
					ObjLevel = 0.1;
					break;
				case '中下':
					ObjLevel = 0.3;
					break;
				case '中':
					ObjLevel = 0.5;
					break;
				case '中上':
					ObjLevel = 0.7;
					break;
				case '难':
					ObjLevel = 0.9;
					break;
			}
			Total = Total + ObjLevel * parseInt(Obj.cells[4].innerHTML);
		}
	}	
	Total = Total / (Math.round($("KTotalNum").innerHTML*100)/100);	
	$("KLevel").innerHTML = Total.toFixed(2);
}
function SaveTitle(SType)
{
	var sql = "";
	var name = "";
	//if ( $("AreaAll") )
	//{
	//	if ( $("AreaG").checked == true && $("AreaM").checked == true )
	//	{
	//		sql = " And (Notes like '%模拟%' Or Notes like '%高考%' ) ";
	//		name = "<span style='color:#000000'>(模拟、高考)</span>";
	//	}
	//	else
	//	{
	//		if ( $("AreaAll").checked == false )
	//		{
	//			if ( $("AreaG").checked == true )
	//			{
	//				sql = " And Notes like '%高考%' ";
	//				name = "<span style='color:#000000'>(高考)</span>";
	//			}
	//			if ( $("AreaM").checked == true )
	//			{
	//				sql = " And Notes like '%模拟%' ";
	//				name = "<span style='color:#000000'>(模拟)</span>";
	//			}
	//		}
	//	}
    //}
	if ( $("SelectTitleNum").value == "0" ) { alert('该题型和难度下没有试题，请重新选择！');return false;}	
	var MName = NowKnowledgeID + "_" +  $("LevelID").options[parseInt($("LevelID").value)-1].text + "_" + $("TitleTypeID").selectedIndex;
	var obj;
	if ( $(MName) )
	{
		obj = $(MName);
		//if ($("AreaAll"))
		//{
		//	obj.sql = sql;
		//}
		if (parseInt($("KExamNum").innerHTML) + parseInt($("SelectTitleNum").value) - parseInt(obj.cells[3].innerHTML) > 10 && parseInt(4) == 4) {alert("题量选择不能超过10题！");return false;}
		$("KExamNum").innerHTML = parseInt($("KExamNum").innerHTML) + parseInt($("SelectTitleNum").value) - parseInt(obj.cells[3].innerHTML);
		$("KTotalNum").innerHTML = Math.round($("KTotalNum").innerHTML*100)/100 + $("TitleScroe").value*$("SelectTitleNum").value - obj.cells[4].innerHTML;
		obj.cells[1].innerHTML = $("TitleTypeID").options[$("TitleTypeID").selectedIndex].text;
		obj.cells[2].innerHTML = $("LevelID").options[parseInt($("LevelID").value)-1].text;
		obj.cells[3].innerHTML = $("SelectTitleNum").value;
		obj.cells[4].innerHTML = $("TitleScroe").value * parseInt($("SelectTitleNum").value);
	}
	else
	{		
		if (parseInt($("KExamNum").innerHTML) + parseInt($("SelectTitleNum").value) > 10 && parseInt(4) == 4) {alert("题量选择不能超过10题！");return false;}
		obj = $("KModels");
		if ( obj.rows[0].cells[0].colSpan == 5 && obj.rows[0].id == "" )
		{
			obj.deleteRow(0);
		}
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.id = MName;
		//if ($("AreaAll"))
		//{
		//	obj.sql = sql;
		//}
		obj.attachEvent("onmouseover",function(){HideWindow();});
		obj.attachEvent("onmousedown",function(){ShowRight1($("MWindow"),obj);});
		obj.attachEvent("onmouseup",function(){TMoveRow1(obj);});
		obj.insertCell(0);
		obj.cells[0].className = "td6";
		obj.cells[0].innerHTML = $("SelTitleArea").childNodes[0].childNodes[0].innerHTML+name;
		ShowKnowledgeNum($("SelTitleArea").childNodes[0].childNodes[0].innerHTML);
		obj.insertCell(1);
		obj.cells[1].className = "td5";
		obj.cells[1].innerHTML = $("TitleTypeID").options[$("TitleTypeID").selectedIndex].text;
		obj.insertCell(2);
		obj.cells[2].className = "td5";
		obj.cells[2].innerHTML = $("LevelID").options[parseInt($("LevelID").value)-1].text;
		obj.insertCell(3);
		obj.cells[3].className = "td5";
		obj.cells[3].innerHTML = $("SelectTitleNum").value;
		obj.insertCell(4);
		obj.cells[4].className = "td7";
		obj.cells[4].innerHTML = $("TitleScroe").value * $("SelectTitleNum").value;
		$("KExamNum").innerHTML = parseInt($("KExamNum").innerHTML) + parseInt($("SelectTitleNum").value);
		$("KTotalNum").innerHTML = Math.round($("KTotalNum").innerHTML*100)/100 + $("TitleScroe").value * parseInt($("SelectTitleNum").value);
	}
	getLevel();
	if ( SType == "SaveExit" )	{SelTitleAreaShow(0);}
}
function ShowKnowledgeNum(Str)
{
	if ( $("KNum_0") )
	{
		var Str = $("KNum_0").innerHTML;
		Str = Str.replace(/&nbsp;/g,"");
		Str = parseInt(Str) + 1;
		$("KNum_0").innerHTML = "&nbsp;" + Str + "&nbsp;";
		return true;
	}
	var KNum = 1;	
	while(Str.indexOf("&gt;")>=0)
	{
		KNum = KNum + 1;
		Str = Str.substring(Str.indexOf("&gt;")+1,Str.length);
	}
	var KName = "Knum_" + KNum;
	if ($(KName))
	{
		$(KName).innerHTML = parseInt($(KName).innerHTML) + 1 +"&nbsp;&nbsp;";
	}
	else
	{
		var Kobj = $("KModels_Result").rows[0].cells[0];
		for ( i=1;i<Kobj.childNodes.length;i++)
		{
			if ( parseInt(Kobj.childNodes[i].id.substring(5,Kobj.childNodes[i].id.length)) == KNum - 1 )
			{
				Str = "";
				for ( j = 0; j<Kobj.childNodes.length;j++)
				{
					if ( j == i  )
					{
						Str = Str + Kobj.childNodes[j].outerHTML + "<span class='blue'>"+KNum+"级考点：</span><span id='Knum_"+KNum+"' class='red'>1&nbsp;&nbsp;</span>";
					}
					else
					{
						Str = Str + Kobj.childNodes[j].outerHTML;
					}
				}
				Kobj.innerHTML = Str;
				i = 0;
				break;					
			}
			if ( parseInt(Kobj.childNodes[i].id.substring(5,Kobj.childNodes[i].id.length)) == KNum + 1 )
			{
				Str = "";
				for ( j = 0; j<Kobj.childNodes.length;j++)
				{					
					if ( j == i - 2 )
					{
						Str = Str + Kobj.childNodes[j].outerHTML + "<span class='blue'>"+KNum+"级考点：</span><span id='Knum_"+KNum+"' class='red'>1&nbsp;&nbsp;</span>" ;
					}
					else
					{
						Str = Str + Kobj.childNodes[j].outerHTML;
					}
				}
				Kobj.innerHTML = Str;
				i = 0;
				break;					
			}				
		}
		if ( i > 0 ) { Kobj.innerHTML = Kobj.innerHTML + "<span class='blue'>"+KNum+"级考点：</span><span id='Knum_"+KNum+"' class='red'>1&nbsp;&nbsp;</span>";}
	}
}
function DelTitleInfor()
{
	var trName = NowKnowledgeID;
	var obj = $("TModels");
	$("TExamNum").innerHTML = parseInt($("TExamNum").innerHTML) - 1;
	$("TTotalNum").innerHTML = parseInt($("TTotalNum").innerHTML) - parseInt($(trName).cells[3].childNodes[0].value);	
	obj.deleteRow($(trName).rowIndex);	
	HideWindow();
	if ( obj.rows.length == 0 )
	{
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.insertCell(0);
		obj.cells[0].colSpan = 5;
		obj.cells[0].className = "norecord";
		obj.cells[0].innerHTML = '试题模板';
		$("TExamNum").innerHTML = "0";
		$("TTotalNum").innerHTML = "0";
		$("TLevel").innerHTML = "0";
		$("Test_Result").rows[0].cells[0].innerHTML = "<span class='bold'>统计：</span>";
	}
	else
	{
		getTLevel();
	}
}
function DelTable()
{
	var trName = NowName;
	var obj = $("KModels");
	$("KExamNum").innerHTML = Math.round($("KTotalNum").innerHTML*100)/100 - $(trName).cells[3].innerHTML;
	$("KTotalNum").innerHTML = Math.round($("KTotalNum").innerHTML*100)/100 - $(trName).cells[4].innerHTML;
	var KNum = 1;
	var Str = $(trName).cells[0].innerHTML;
	while(Str.indexOf("&gt;")>=0)
	{
		KNum = KNum + 1;
		Str = Str.substring(Str.indexOf("&gt;")+1,Str.length);
	}
	var KName = "Knum_" + KNum;
	if($(KName))
	{$(KName).innerHTML = parseInt($(KName).innerHTML) - 1;}
	obj.deleteRow($(trName).rowIndex);	
	HideWindow();
	if ( obj.rows.length == 0 )
	{
		obj.insertRow(obj.rows.length);
		obj = obj.rows[obj.rows.length-1];
		obj.insertCell(0);
		obj.cells[0].colSpan = 5;
		obj.cells[0].className = "norecord";
		obj.cells[0].innerHTML = '试题模板';
		$("KExamNum").innerHTML = "0";
		$("KTotalNum").innerHTML = "0";
		$("KLevel").innerHTML = "0";
		$("KModels_Result").rows[0].cells[0].innerHTML = "<span class='bold'>统计：</span>";
	}
	else
	{
		getLevel();
	}
}
function GetFolderList(skid)
{
	var obj;	
	if ( parseInt(skid) == 0 )
	{
		obj = $("List1");
	}
	else
	{
		var name;
		if ( parseInt(SaveKindID) > 0 )
		{
			name = "trF_" + SaveKindID;
			if ($(name))
			{
				$(name).style.backgroundColor = "";			
			}
		}
		name = "imgF_" + skid;
		obj = $(name);
		if ( obj.src.indexOf("fclose") > 0 )
		{
			obj.src = "images/new/fopen.gif";
			name = obj.parentNode.parentNode.parentNode.parentNode.id
			//SaveKindID = parseInt(name.substring(name.indexOf("_")+1,name.length));
			name = "trF_" + skid;
			obj = $(name);			
			obj.style.backgroundColor = "";
			obj.name = "";
			name = "NextF_" + skid;
			obj = $(name);
			obj.style.display = "none";
			return;
		}
		else
		{
			if ( obj.src.indexOf("fopen") > 0 )
			{
				obj.src = "images/new/fclose.gif";
			}
			name = "trF_" + skid;
			obj = $(name);
			obj.style.backgroundColor = "#e1ecf8";
			name = "imgF_" + skid;
			obj = $(name);
			if ( obj.src.indexOf("folder") > 0 ) 
			{
			 	//SaveKindID = skid;
				return;
			}
			name = "NextF_" + skid;
			obj = $(name);
			obj.style.display = "block";
		}
	}
	if ( FoldersType == 'GetFolderList' || FoldersType == 'GetTestList' )
	{
		url = "folder.asp?DoType=GetFolderList&TestModelID="+Library+"&SaveKindID="+skid;
	}
	else
	{
		url = "folder.asp?DoType=GetShareFolderList&TestModelID="+Library+"&SaveKindID="+skid;
	}
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");	
	xmlhttp.open("GET",url,false);
	xmlhttp.send();
	//SaveKindID = skid;
	if ( parseInt(skid) == 0 )
	{
		obj.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	}
	else
	{
		obj.cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	}
}
function ShowFolderList(dotype,L)
{
	if ( L < 3 && ButtonType != "gxsj" )
	{
		var obj = $("KModels");	
		if (obj)
		{
			if ( obj.rows[0].cells[0].colSpan == 5 && obj.rows[0].id == "" )
			{
				return false;
			}	
			Library = L;
		}
	}
	else
	{
		if ( Library != 2)
		{
			Library = 1;
		}
	}
	FoldersType = dotype;
	if ( Library == 1 )
	{
		$("Window").childNodes[0].childNodes[0].childNodes[0].innerHTML = '试卷库管理文件夹';
	}
	else
	{
		$("Window").childNodes[0].childNodes[0].childNodes[0].innerHTML = '模版库管理文件夹';
	}	
	$("Window").style.display = "block";
	var x=getX($("LibraryList"))+150;
	var y=getY($("LibraryList"))+40;
	$("Window").style.left = x;
	$("Window").style.top = y;	
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";	
	GetFolderList(0);
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = true;
	}
	
}
function ShowSaveName(SKID)
{	
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	if ( !$("AreaAll") )
	{
		CopySaveKindID = SKID;	
		
		if ( CType == "UploadFolder" )
		{
			xmlhttp.open("GET","folder.asp?DoType=GetTrueName",false);
			xmlhttp.send();
			$("SaveName").childNodes[0].childNodes[0].childNodes[0].innerHTML = '文件保存至' + bytes2BSTR(xmlhttp.ResponseBody) + '共享文件夹';
		}
		else
		{
			xmlhttp.open("GET","folder.asp?DoType=GetFileName&SaveKindID="+SKID,false);
			xmlhttp.send();
			$("SaveName").childNodes[0].childNodes[0].childNodes[0].innerHTML = '文件保存至' + bytes2BSTR(xmlhttp.ResponseBody);
		}
	}
	$("Window").style.display = "none";
	$("SaveName").style.display = "block";	
	var x=document.documentElement.scrollLeft + 200;
	var y= 150;
	if(navigator.appVersion.match(/6./i)=='6.') 
   {
		  y = document.documentElement.scrollTop + y;
   }
	$("SaveName").style.left = x;
	$("SaveName").style.top = y;	
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";
	var MaxID = document.getElementsByTagName("select").length;
	for (i=0;i<MaxID;i++)
	{
		document.getElementsByTagName("select")[i].disabled = true;
	}
	if ( CType != "" )
	{
		xmlhttp.open("GET","folder.asp?DoType=GetFileName&SaveKindID="+SaveKindID,false);
		xmlhttp.send();
		$("SaveKindName").value = bytes2BSTR(xmlhttp.ResponseBody);
	}	
}
var xmlHTTP;
function SaveKName()
{		
	if (parseInt(4) == 4)
	{						
		var obj = $("KModels");
		var PaperContent = "";
		var TID = "";
		createXMLHttp(); 
		for ( i = 0; i < obj.rows.length; i++)
		{
			if ( obj.rows[i].cells[0].colSpan == 5 )
			{
				PaperContent = PaperContent + "#SYFenGe#" + obj.rows[i].cells[0].innerHTML + "#SYFenGe#";
			}
			else
			{
				var Obj = obj.rows[i];
				var ObjId = Obj.id.substring(0,Obj.id.indexOf("_"));
				var ObjType = Obj.id.substring(Obj.id.length-1,Obj.id.length);
				ObjType = $("TitleTypeID").options[parseInt(ObjType)].value;
				var ObjLevel;
				switch(Obj.cells[2].innerHTML)
				{
					case '易':
						ObjLevel = 1;
						break;
					case '中下':
						ObjLevel = 2;
						break;
					case '中':
						ObjLevel = 3;
						break;
					case '中上':
						ObjLevel = 4;
						break;
					case '难':
						ObjLevel = 5;
						break;
				}
					//建立xmlHttp 对象	
				var sql="";
				if (Obj.sql)
				{
					sql = Obj.sql;
				}
				var send_string="DoType=SavePaper4&KnowledgeID="+ObjId+"&LevelID="+ObjLevel+"&SelectTitleNum="+Obj.cells[3].innerHTML+"&TitleScroe="+Obj.cells[4].innerHTML+"&TitleTypeID="+ObjType+"&sql="+escape(sql)+"&TID="+TID;
				send_string= encodeURI(send_string);		
				xmlHTTP.open("post","folder.asp",false); //传送方式 读取的页面 异步与否
				xmlHTTP.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); 
				xmlHTTP.send(send_string); //发送
				//return;
				//TID = TID + xmlHTTP.responseText.replace("|",",").substring(0,xmlHTTP.responseText.length-1);
				PaperContent = PaperContent + xmlHTTP.responseText;	
			}	
		}
		//alert($("PaperContent"))
        $("PaperContent").value = PaperContent;
        //alert($("SaveKindName").value)
		window.open("paper.asp?SaveKindName="+escape($("SaveKindName").value))
		HideShow();
		return;
	}
	if ( $("SaveKindName").value == "" ) { alert('文件名称不能为空，请重新填写！'); return;}	
	if ( CType == "UploadFolder" )
	{		
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");		
		xmlhttp.open("GET","folder.asp?DoType=AddShareFile&SaveKindName="+$("SaveKindName").value+"&SaveKindID="+SaveKindID+"&TestModelID="+Library,false);
		xmlhttp.send();	
		var nextname = "SFolderNext_" + bytes2BSTR(xmlhttp.ResponseBody);
		var trname = "SFoldertr_" + bytes2BSTR(xmlhttp.ResponseBody);
		var SID = bytes2BSTR(xmlhttp.ResponseBody);
		if ( $(nextname) )
		{
			if ( $(nextname).style.display == "block" )
			{
				xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID="+ SID +"&TestModelID="+Library,false);
				xmlhttp.send();
				$(nextname).cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			else
			{
				ShowSFolder(SID,$(trname));
			}
		}
		else
		{
			xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID=0&TestModelID="+Library,false);
			xmlhttp.send();
			$("Library_S_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			ShowSFolder(SID,$(trname));
		}
		//ObjTemp.cells[0].childNodes[0].innerHTML = "&nbsp;" + $("SaveKindName").value;
		HideShow();
		return;
	}	
	if ( CopySaveKindID != "")
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=CheckName&SaveKindID="+CopySaveKindID+"&SaveKindName="+$("SaveKindName").value,false);
		xmlhttp.send();
		if ( bytes2BSTR(xmlhttp.ResponseBody) == '当前文件夹已经存在，请重新填写文件夹名称！' ) { alert(bytes2BSTR(xmlhttp.ResponseBody)); return;}	
	}
	else
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=CheckName&SaveKindID="+$("SelectKindName").value+"&SaveKindName="+$("SaveKindName").value,false);
		xmlhttp.send();
		if ( bytes2BSTR(xmlhttp.ResponseBody) == '当前文件夹已经存在，请重新填写文件夹名称！' ) { alert(bytes2BSTR(xmlhttp.ResponseBody)); return;}
	}	
	if ( FoldersType == "GetTestList" )
	{
		SaveKindID = CopySaveKindID;
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");		
		xmlhttp.open("GET","folder.asp?DoType=SaveTestKnowledge&SaveKindName="+$("SaveKindName").value,false);
		xmlhttp.send();	
		var KID = bytes2BSTR(xmlhttp.ResponseBody);
		xmlhttp.open("GET","folder.asp?DoType=SaveFile&TestModelID="+Library+"&SaveKindID="+SaveKindID+"&SaveKindName="+$("SaveKindName").value+"&PaperContent=TestInsert&KnowledgeID="+KID,false);
		xmlhttp.send();
		var SKID = bytes2BSTR(xmlhttp.ResponseBody);
		window.open("ExamInsert.asp?SaveKindID="+SKID+"&KnowledgeID="+KID);
		HideShow();
		return;
	}
	if ( TitleID != "" )
	{
		SaveKindID = CopySaveKindID;
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=SaveFile&TestModelID="+Library+"&SaveKindID="+SaveKindID+"&SaveKindName="+$("SaveKindName").value,false);		
		xmlhttp.send();			
		var xmlhttp = bytes2BSTR(xmlhttp.ResponseBody);		
		xmlhttp.open("GET","folder.asp?DoType=SaveNotePaper&SaveKindID="+SKID+"&TitleInforID="+TitleID,false);
		xmlhttp.send();
		ShowChooseSelectKindName();
		ShowChooseFile();
		if ( parseInt(4) == 6 || parseInt(4) == 3 )
		{
			CheckPublishFolder(SKID);
		}
		HideShow();
		return;
	}
	if ( CType == "ChangeFolderName" )
	{		
		xmlhttp.open("GET","folder.asp?DoType=ChangeFolder&SaveKindName="+$("SaveKindName").value+"&SaveKindID="+SaveKindID,false);
		xmlhttp.send();		
		ObjTemp.cells[0].childNodes[0].innerHTML = "&nbsp;" + $("SaveKindName").value;
		HideShow();
		return;
	}
	if ( CType != "" && CType != null ) { CopyFolder(); HideShow(); return;}		
	if ( $("KModels").rows[0].cells[0].colSpan == 5 && $("KModels").rows[0].id == "" )
	{
		alert("请先选好考点再进行添加！");
		return;
	}
	else
	{
		//SaveKindID = CopySaveKindID; 
		//保存试卷和保存模板，首先在SaveKinds根据名字生成这份记录的信息
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=SaveFile&TestModelID="+Library+"&SaveKindID="+CopySaveKindID+"&SaveKindName="+$("SaveKindName").value,false);
		xmlhttp.send();			
		var SKID = bytes2BSTR(xmlhttp.ResponseBody);					
		var obj = $("KModels");
		//该项为该份试卷做为记录信息用，大题之间用#SYFenGe#来分割，小题之间的modelid用|进行分割
		var PaperContent = "";
		//获取每一行的数据
		for ( i = 0; i < obj.rows.length; i++)
		{
			//判断考点列表中的行是大题的标题还是选中的考点，大题的标题只有1列
			if ( obj.rows[i].cells[0].colSpan == 5 )
			{
				PaperContent = "#SYFenGe#" + obj.rows[i].cells[0].innerHTML + "#SYFenGe#";
				xmlhttp.open("GET","folder.asp?DoType=SavePaperContent&SaveKindID="+SKID+"&PaperContent="+escape(PaperContent),false);
				xmlhttp.send();	
			}
			else
			{
				var Obj = obj.rows[i];
				var ObjId = Obj.id.substring(0,Obj.id.indexOf("_"));
				var ObjType = Obj.id.substring(Obj.id.length-1,Obj.id.length);
				ObjType = $("TitleTypeID").options[parseInt(ObjType)].value;
				var ObjLevel;
				switch(Obj.cells[2].innerHTML)
				{
					case '易':
						ObjLevel = 1;
						break;
					case '中下':
						ObjLevel = 2;
						break;
					case '中':
						ObjLevel = 3;
						break;
					case '中上':
						ObjLevel = 4;
						break;
					case '难':
						ObjLevel = 5;
						break;
				}
				//判断是模板类型保存还是试卷类型保存
				if ( parseInt(Library) == 2 )
				{				
					xmlhttp.open("GET","folder.asp?DoType=SaveKnowledge&SaveKindID="+SKID+"&KnowledgeID="+ObjId+"&LevelID="+ObjLevel+"&SelectTitleNum="+Obj.cells[3].innerHTML+"&TitleScroe="+Obj.cells[4].innerHTML+"&TitleTypeID="+ObjType,false);
					xmlhttp.send();				
				}
				else
				{				
					xmlhttp.open("GET","folder.asp?DoType=SavePaper&SaveKindID="+SKID+"&KnowledgeID="+ObjId+"&LevelID="+ObjLevel+"&SelectTitleNum="+Obj.cells[3].innerHTML+"&TitleScroe="+Obj.cells[4].innerHTML+"&TitleTypeID="+ObjType,false);
					xmlhttp.send();
				}
				//alert(bytes2BSTR(xmlhttp.ResponseBody));
			}			
		}
		if ( parseInt(4) == 6 || parseInt(4) == 3 )
		{
			CheckPublishFolder(SKID)
		}	
		HideShow();
	}	
}
function CopyFolder()
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType="+CType+"&TestModelID="+Library+"&SaveKindID="+SaveKindID+"&CopySaveKindID="+CopySaveKindID+"&SaveKindName="+$("SaveKindName").value,false);
	xmlhttp.send();	
	if ( bytes2BSTR(xmlhttp.ResponseBody) == "")
	{
		alert("操作成功！");
	}
	else
	{
		alert("操作失败！请重试，如多次操作失败请联系管理员！");
	}
	//ShowChooseSelectKindName();
	//ShowChooseFile();
	CType = "";
}
function ChangeFolderName()
{	
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=GetFileName&SaveKindID="+SaveKindID,false);
	xmlhttp.send();
	$("SaveName").style.display = "block";
	$("ModelWindow1").style.display = "none";
	$("ModelWindow2").style.display = "none";
	$("SaveKindName").value = bytes2BSTR(xmlhttp.ResponseBody);
	var x=document.documentElement.scrollLeft + 200;
	var y= 150;
	if(navigator.appVersion.match(/6./i)=='6.') 
   {
		  y = document.documentElement.scrollTop + y;
   }
	$("SaveName").style.left = x;
	$("SaveName").style.top = y;	
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";
	CType = "ChangeFolderName";
}
function DelAllTable(DelType){
	var obj = $("KModels");
	$("KExamNum").innerHTML = "0";
	$("KTotalNum").innerHTML = "0";
	$("KLevel").innerHTML = "0";
	$("KModels_Result").rows[0].cells[0].innerHTML = "<span class='bold'>统计：</span>";
	var maxrow = obj.rows.length;
	for ( i=0; i<maxrow; i++)
	{
		obj.deleteRow(0);
	}	
	HideWindow();
	obj.insertRow(0);
	obj = obj.rows[0];
	obj.insertCell(0);
	obj.cells[0].colSpan = 5;
	obj.cells[0].className = "norecord";
	if ( DelType == 1 )
	{
		obj.cells[0].innerHTML = "通过考点建设栏目右侧的“选题”按钮即可进行考点选择!右键可添加题目！";	
	}
	else
	{
		obj.cells[0].innerHTML = "单击试卷或者模版名称将会载入该试卷或者模版考点！通过点击试题组卷可重新组卷！";	
	}
}
function ChangeClass(obj,classnum)
{	
	if ( obj.value == "" ) {alert("文件名称不能为空，请重新填写！");return;}
	if ( classnum == 0 )
	{
		obj.className = "Noinput";		
	}
	else
	{
		obj.className = "Yesinput";
		if ( FType == "") { FType = "Edit";}
	}
	if ( FType == "Edit" && classnum == 0 )
	{
		var SKindID = obj.id.substring(obj.id.indexOf("_")+1,obj.length);
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=ChangeFolder&TestModelID="+Library+"&SaveKindName="+obj.value+"&SaveKindID="+SKindID,false);
		xmlhttp.send();
	}
	if ( FType == "Add" && classnum == 0)
	{
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=AddFolder&TestModelID="+Library+"&SaveKindName="+obj.value+"&SaveKindID="+SaveKindID,false);
		xmlhttp.send();		
		if ( bytes2BSTR(xmlhttp.ResponseBody) == "" )
		{
			alert("当前文件夹已经存在，请重新填写文件夹名称！");
			return false;
		}		
		else
		{
			var newSaveKindID = bytes2BSTR(xmlhttp.ResponseBody);	
			FType = "Edit";	
			if ( $("Window").style.display == 'block' )
			{
				var html = obj.value;				
				url = "folder.asp?DoType=GetNum&SaveKindID="+SaveKindID;	
				xmlhttp.open("GET",url,false);
				xmlhttp.send();
				html = "<img id='imgF_" + newSaveKindID + "' style='margin-left:" + bytes2BSTR(xmlhttp.ResponseBody) + "px;' src='images/new/folder.gif' />&nbsp;" + html + "";
				obj = obj.parentNode;
				obj.innerHTML = html;
				obj = obj.parentNode.parentNode;
				//obj.parentNode.attachEvent("onclick",function(){GetFolderList(newSaveKindID)});
				obj = obj.cells[1];						
				//obj.style.cursor = "pointer";
				obj.innerHTML = "<div class='LLDRight' onclick='ShowSaveName("+ newSaveKindID +")'>存于此处</div>";
			}	
		}
	}
}
function FolderType(FT)
{
	FType = FT;
	var obj;
	obj = "SW_" + SaveKindID;
	obj = $(obj);
	if ( !obj )
	{
		obj = $("SW_0");
		SaveKindID = 0;
	}
	if ( parseInt(SaveKindID) > 0 )
	{
		var Obj = obj.parentNode.parentNode;
		Obj = Obj.parentNode.rows[Obj.rowIndex-1].cells[0].childNodes[0].childNodes[0];
		Obj.src = 'images/new/fclose.gif';
	}
	obj.insertRow(obj.rows.length);
	obj = obj.rows[obj.rows.length-1];
	obj.insertCell(0);
	obj.cells[0].className = "td1";
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	url = "folder.asp?DoType=GetNum&SaveKindID="+SaveKindID;	
	xmlhttp.open("GET",url,false);
	xmlhttp.send();
	obj.cells[0].innerHTML = "<div class='Ktitle'><img style='margin-left:" + bytes2BSTR(xmlhttp.ResponseBody) + "px;' src='images/new/folder.gif' />&nbsp;<input id='folder_new' size='38' onFocus='ChangeClass(this,1)' onBlur='ChangeClass(this,0)' type='text' class='Yesinput'  size='15' /></div>";
	obj.insertCell(1);
	obj.cells[1].className = "td2";
	obj.cells[1].innerHTML = "&nbsp;";
	$("folder_new").focus();
	$("folder_new").value = "新建文件夹";
}
function ShowFolder(SKID,obj)
{
	var TrName = "Foldertr_"+SaveKindID;
	if ( $(TrName) )
	{
		$(TrName).style.backgroundColor = "";
	}
	obj.style.backgroundColor = "#c1dcfa";
	SaveKindID = SKID;
	var NextName = "FolderNext_" + SKID;
	var ImgName = "Folderimg_" + SKID;		
	if ( !$(ImgName) || $(ImgName).src.indexOf("folder") > 0 ) { return ;}
	if ( $(ImgName).src.indexOf("fcloses") > 0 && CopyType != "FV" )
	{
		$(NextName).style.display = "none";
		$(ImgName).src = "images/new/fopens.gif";		
	}
	else
	{		
		if ( $(NextName).cells[0].innerHTML == "" || CopyType == "FV" )
		{
			xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID="+SKID+"&TestModelID="+Library,false);
			xmlhttp.send();
			if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
			{
				$(NextName).style.display = "block";
				$(ImgName).src = "images/new/fcloses.gif";
				$(NextName).cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			else
			{
				alert("该文件夹下没有试卷或者文件夹，可通过复制、剪切功能将试卷移动到该文件夹下方！");
			}
		}
		else
		{
			$(NextName).style.display = "block";
			$(ImgName).src = "images/new/fcloses.gif";
		}		
	}
}

function ShowSFolder(SKID,obj)
{
	var TrName = "SFoldertr_"+SaveKindID;
	if ( $(TrName) )
	{
		$(TrName).style.backgroundColor = "";
		if ($(TrName).cells[0].childNodes.length > 1)
		{
			$(TrName).cells[0].childNodes[1].style.display = "none";
			$(TrName).cells[0].childNodes[2].style.display = "none";
		}		
	}
	obj.style.backgroundColor = "#c1dcfa";
	if (obj.cells[0].childNodes.length > 1)
	{
		obj.cells[0].childNodes[1].style.display = "block";
		obj.cells[0].childNodes[2].style.display = "block";
	}
	SaveKindID = SKID;
	var NextName = "SFolderNext_" + SKID;
	var ImgName = "SFolderimg_" + SKID;		
	if ( !$(ImgName) || $(ImgName).src.indexOf("folder") > 0 ) { return ;}
	if ( $(ImgName).src.indexOf("fclose") > 0 && CopyType != "FV" )
	{
		$(NextName).style.display = "none";
		$(ImgName).src = "images/new/fopen.gif";		
	}
	else
	{		
		if ( $(NextName).cells[0].innerHTML == "" || CopyType == "FV" )
		{
			xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID="+SKID+"&TestModelID="+Library,false);
			xmlhttp.send();
			if ( bytes2BSTR(xmlhttp.ResponseBody) != "" )
			{
				$(NextName).style.display = "block";
				$(ImgName).src = "images/new/fclose.gif";
				$(NextName).cells[0].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			else
			{
				alert("该文件夹下没有试卷或者文件夹，可通过复制、剪切功能将试卷移动到该文件夹下方！");
			}
		}
		else
		{
			$(NextName).style.display = "block";
			$(ImgName).src = "images/new/fclose.gif";
		}		
	}
}
var FileSaveKindID;
function ShowRight2(FSKID,own,Obj)
{	
	//为鼠标左键移动试卷做准备
	if(window.event.button==1)
	{
		var WinName = "ModelWindow" + Library;		
		WinName = $(WinName);
		var obj = "Foldertr_" + FSKID;
		obj = $(obj);
		FileSaveKindID = FSKID;
		//alert(obj.parentNode.outerHTML)
		if ( obj.parentNode.parentNode )
		{
			MoveTable = obj.parentNode.parentNode;
			MoveRow = obj;
			onMouseDown = true;
			$("Library_Content").style.cursor = "move";
		}
	}
	if(Obj != null || (parseInt(window.event.button)%2) ==0)
	{		
		var WinName = "ModelWindow" + Library;		
		WinName = $(WinName);
		var obj = "Foldertr_" + FSKID;
		obj = $(obj);
		if ( type == 'Share' )
		{	
			if ( obj )
			{
				
				WinName.childNodes[0].style.display = "block";
				WinName.childNodes[1].style.display = "none";
				WinName.childNodes[3].style.display = "block";
				WinName.childNodes[4].style.display = "block";
				WinName.childNodes[5].style.display = "block";
				WinName.childNodes[6].style.display = "block";
				WinName.childNodes[7].style.display = "block";
				if ( Library == 2 )
				{
					WinName.childNodes[2].style.display = "none";
				}
			}
			else
			{
				WinName.childNodes[0].style.display = "none";
				WinName.childNodes[1].style.display = "block";
				WinName.childNodes[3].style.display = "none";
				WinName.childNodes[4].style.display = "none";
				WinName.childNodes[5].style.display = "none";
				WinName.childNodes[6].style.display = "block";
				WinName.childNodes[7].style.display = "block";
				//WinName.childNodes[8].style.display = "none";
				if ( Library == 2 )
				{
					//WinName.childNodes[2].style.display = "block";
				}	
				if ( own == "no" )
				{
					WinName.childNodes[2].style.display = "block";
					WinName.childNodes[6].style.display = "none";
					WinName.childNodes[7].style.display = "none";
				}	
				else
				{
					WinName.childNodes[2].style.display = "block";
				}
				//WinName.childNodes[WinName.childNodes.length-1].style.display = "none";
			}
		}
		else
		{
			WinName.childNodes[0].style.display = "none";
			WinName.childNodes[1].style.display = "none";
			WinName.childNodes[6].style.display = "block";
			WinName.childNodes[7].style.display = "block";
			var obj = "Foldertr_" + FSKID;
			obj = $(obj);
			if (obj.PaperContent=="1" && Library == 1)
			{
				WinName.childNodes[2].style.display = "block";
			}
			else
			{
				WinName.childNodes[2].style.display = "none";
			}
			if (obj.KnowledgeID!="0")
			{
				WinName.childNodes[8].style.display = "block";
			}
			else
			{
				//WinName.childNodes[8].style.display = "none";
			}
		}
		WinName.style.display = "block";
		var x=getX(Obj);
        var y= getY(Obj);
		//var x=document.documentElement.scrollLeft + event.x;
        //var y= event.y;	
		//if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   //{
		//	  y = document.documentElement.scrollTop + y;
	   //}
		WinName.style.left = x;
		WinName.style.top = y;
		FileSaveKindID = FSKID;
		ObjTemp = "Foldertr_" + FSKID;
		ObjTemp = $(ObjTemp)
		if ( !ObjTemp )
		{
			ObjTemp = "SFoldertr_" + FSKID;
			ObjTemp = $(ObjTemp)
		}
	}
}
function Upload()
{
	$("ModelWindow1").style.display = "none";
	$("ModelWindow2").style.display = "none";	
	CType = "UploadFolder";
	ShowSaveName();
}
function Download()
{
	$("ModelWindow1").style.display = "none";
	$("ModelWindow2").style.display = "none";	
	CType = "CopyShareFolder";
	ShowFolderList('GetFolderList',Library);
	//$("FolderList").childNodes[0].childNodes[0].childNodes[3].style.display = 'block';
//	if ( Library == 1 )
//	{
//		$("FolderList").childNodes[0].childNodes[0].childNodes[0].innerHTML = '下载至个人试卷库';
//	}
//	else
//	{
//		$("FolderList").childNodes[0].childNodes[0].childNodes[0].innerHTML = '下载至个人模版库';
//	}	
}
function ShowRight3(FSKID,Obj)
{	
	//if((parseInt(window.event.button)%2) ==0)
	//{		
		var WinName = "FWindow";
		if ( parseInt(FSKID)==0 )
		{
			WinName = "FWindow0";
		}
		WinName = $(WinName);		
		WinName.style.display = "block";
		var x=getX(Obj);
        var y= getY(Obj);
		//var x=document.documentElement.scrollLeft + event.x;
        //var y= event.y;	
		//if( navigator.appVersion.indexOf("MSIE 6.0") >= 0 )
	   //{
			//  y = document.documentElement.scrollTop + y;
	   //}
		WinName.style.left = x;
		WinName.style.top = y;
		SaveKindID = FSKID;
		FileSaveKindID = FSKID;
		ObjTemp = "Foldertr_" + FSKID;
		ObjTemp = $(ObjTemp);
		var MName = "ModelWindow" + Library;
		$("FWindow").childNodes[3].style.color = $(MName).childNodes[5].style.color;		
	//}
}
function DelSaveKind()
{
	if(window.confirm("确实要删除吗？")){
		var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
		xmlhttp.open("GET","folder.asp?DoType=DelSaveKind&TestModelID="+Library+"&SaveKindID="+FileSaveKindID,false);
		xmlhttp.send();
		if(bytes2BSTR(xmlhttp.ResponseBody)=='0'){ObjTemp.parentNode.removeChild(ObjTemp); }
		else{alert('删除失败！');}
	}
	HideWindow();
}
function OpenExamInsert()
{
	var obj = "Foldertr_" + FileSaveKindID;
	obj = $(obj);
	window.open("ExamInsert.asp?SaveKindID="+FileSaveKindID+"&KnowledgeID="+obj.KnowledgeID);
}
function OpenPaper(SaveKindID)
{
	if (SaveKindID !=null)
	{window.open("paperlist.asp?SaveKindID="+SaveKindID);}
	else
	{window.open("paperlist.asp?SaveKindID="+FileSaveKindID);}
	HideWindow();
}
function ShowButton(obj,next)
{
	var Obj;
	if ( type == 'Share' )
	{
		if ( obj.id.indexOf("_") > 0 )
		{
			Obj = $(obj.id.substring(0,obj.id.indexOf("_")));
		}
		else
		{
			Obj = $(obj.id+"_S");
		}
	}
	obj.className = "textclick";
	if ( type == 'Share' ) { Obj.className = "textclick"; }
	if ( next == "2" )
	{
		obj.previousSibling.className = "text";		
		if ( type == 'Share' ) { Obj.previousSibling.className = "text"; }
	}
	if ( next == "1" )
	{
		obj.nextSibling.className = "text";
		if ( type == 'Share' ) { Obj.nextSibling.className = "text"; }
	}
	Library = parseInt(next);
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID=0&TestModelID="+Library,false);
	xmlhttp.send();
	$("Library_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	if ( type == "Share" )
	{
		xmlhttp.open("GET","folder.asp?DoType=CallShareFolder&SaveKindID=0&TestModelID="+Library,false);
		xmlhttp.send();
		$("Library_S_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	}
}
function ShowKnowledge(SKindID,obj)
{
	//alert(SKindID)
	if ( Library == 1 && $("PStore").className != "textclick") { Library = 2; }
	if ( Library == 2 && $("PStore").className == "textclick") { Library = 1; }
	
	if (obj)
	{
		obj.style.backgroundColor = "#c1dcfa";	
		var TrName = "Foldertr_"+SaveKindID;	
		if ( $(TrName) )
		{
			$(TrName).style.backgroundColor = "";
		}
		TrName = "SFoldertr_"+SaveKindID;
		if ( $(TrName) )
		{
			$(TrName).style.backgroundColor = "";
			SaveKindID = SKindID;
			return;
		}
	}
	SaveKindID = SKindID;
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=ShowKnowledge&SaveKindID=" + SKindID + "&TestModelID="+Library,false);
	xmlhttp.send();	
	//alert(bytes2BSTR(xmlhttp.ResponseBody))
	$("KnowledgeTemple_Content").innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
}
function CheckPublishFolder(SID)
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=CheckPublish&SaveKindID="+SID,false);
	xmlhttp.send();
	if (bytes2BSTR(xmlhttp.ResponseBody) == "ok" )
	{
		xmlhttp.open("GET","getExamPaper.asp?DoType=SaveSEP&SaveKindID="+SID,false);
		xmlhttp.send();	
		xmlhttp.open("GET","getExamPaper.asp?DoType=SavePaper&ShowAnswer=ok&SaveKindID="+SID,false);
		xmlhttp.send();	
		xmlhttp.open("GET","getExamPaper.asp?DoType=SavePaper&SaveKindID="+SID,false);
		xmlhttp.send();	
	}
}
function CopyPaper(CPType)
{
	var MName = "ModelWindow" + Library;
	if ( CPType.indexOf("V") < 0 )
	{
		CSaveKindID = FileSaveKindID;
		CopyType = CPType;
		var FName = "Foldertr_" + FileSaveKindID;
		$(FName).cells[0].childNodes[0].style.color = "#FF0000";
		$(MName).childNodes[5].style.color = "#0f3460";		
	}
	else
	{
		if ( ( $(MName).style.display == "block" && $(MName).childNodes[5].style.color == "#999999" ) || ( $("FWindow").style.display == "block" && $("FWindow").childNodes[3].style.color == "#999999") )
		{
			alert("请先选择试卷并复制或者剪切后再进行此操作！");
			$(MName).style.display = "none";
			$("FWindow").style.display = "none";
			return false;
		}
		$(MName).childNodes[5].style.color = "#999999";	
		if ( CopyType == 'X' )
		{
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=FolderCut&OSaveKindID=" + CSaveKindID + "&NSaveKindID=" + FileSaveKindID + "&CPType=" + CPType,false);
			xmlhttp.send();
			if ( parseInt(4) == 6 || parseInt(4) == 3 )
			{
				CheckPublishFolder(CSaveKindID);
			}
			var FName = "Foldertr_" + CSaveKindID;
			$(FName).parentNode.deleteRow($(FName).rowIndex);
			CopyType = CPType;
			if ( CPType == "V" )
			{
				FName = "Foldertr_" + FileSaveKindID;
				FName = $(FName).parentNode.parentNode.id;
				FName = FName.substring(7,FName.length);
				xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID="+FName+"&TestModelID="+Library,false);
				xmlhttp.send();
				FName = "Foldertr_" + FileSaveKindID;
				$(FName).parentNode.parentNode.parentNode.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			else
			{
				FName = "Foldertr_" + FileSaveKindID;
				ShowFolder(FileSaveKindID,$(FName));
			}
		}
		else
		{
			var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
			xmlhttp.open("GET","folder.asp?DoType=FolderCopy&OSaveKindID=" + CSaveKindID + "&NSaveKindID=" + FileSaveKindID + "&CPType=" + CPType,false);
			xmlhttp.send();
			if ( parseInt(4) == 6 || parseInt(4) == 3 )
			{
				CheckPublishFolder(bytes2BSTR(xmlhttp.ResponseBody));
			}
			var FName = "Foldertr_" + CSaveKindID;
			$(FName).cells[0].childNodes[0].style.color = "#0067b4";
			if ( CPType == "V" )
			{
				FName = "Foldertr_" + FileSaveKindID;
				FName = $(FName).parentNode.parentNode.id;
				FName = FName.substring(7,FName.length);
				xmlhttp.open("GET","folder.asp?DoType=CallFolder&SaveKindID="+FName+"&TestModelID="+Library,false);
				xmlhttp.send();
				FName = "Foldertr_" + FileSaveKindID;
				$(FName).parentNode.parentNode.parentNode.innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
			}
			else
			{
				FName = "Foldertr_" + FileSaveKindID;
				ShowFolder(FileSaveKindID,$(FName));
			}
		}
		CSaveKindID = "";
		CopyType = "";		
	}
	$(MName).style.display = "none";
	$("FWindow").style.display = "none";
}
function ShowSearch()
{
	$("SearchNote").style.display = "block";	
	var x=document.documentElement.scrollLeft + 200;
	var y= 150;
	if(navigator.appVersion.match(/6./i)=='6.') 
   {
		  y = document.documentElement.scrollTop + y;
   }
	$("SearchNote").style.left = x;
	$("SearchNote").style.top = y;	
	$("Over").style.height = document.body.offsetHeight;
	$("Over").style.display = "block";	
}
function ChangeDisplay(obj,tid)
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","knowledge.asp?DoType=ChangeDisplay&TitleTypeID="+tid+"&Display="+obj.checked,false);
	xmlhttp.send();
	ChangeButton($("banner").childNodes[1],'kdjs');
}
function ChangeArea(obj)
{
	if ( obj.id == "AreaAll" )
	{
		$("AreaM").checked = false;
		$("AreaG").checked = false;
	}
	else
	{
		$("AreaAll").checked = false;
	}
	ShowTitleNum();
}
function ChangeFolderShowType(obj)
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=ChangeShowType&SaveKindID="+obj.savekindid,false);
	xmlhttp.send();	
	if ( obj.checked )
	{
		obj.nextSibling.style.color = "#004986";
		var sid = bytes2BSTR(xmlhttp.ResponseBody).split(",");
		for (i=0;i<sid.length;i++)
		{
			xmlhttp.open("GET","getExamPaper.asp?DoType=SaveSEP&SaveKindID="+sid[i],false);
			xmlhttp.send();	
			xmlhttp.open("GET","getExamPaper.asp?DoType=SavePaper&ShowAnswer=ok&SaveKindID="+sid[i],false);
			xmlhttp.send();
			xmlhttp.open("GET","getExamPaper.asp?DoType=SavePaper&SaveKindID="+sid[i],false);
			xmlhttp.send();
		}
	}
	else
	{
		obj.nextSibling.style.color = "#959595";
	}	
}
function Search()
{
	var xmlhttp=new ActiveXObject("Msxml2.xmlhttp");
	xmlhttp.open("GET","folder.asp?DoType=SearchNote&Note="+$("Note").value,false);
	xmlhttp.send();
	$("SearchList").style.display = "block";
	var x=getX($("LibraryList"))+150;
	var y=getY($("LibraryList"))+40;
	$("SearchList").style.left = x;
	$("SearchList").style.top = y;
	$("SearchNote").style.display = "none";
	$("SearchList").childNodes[1].innerHTML = bytes2BSTR(xmlhttp.ResponseBody);
	SYLatexEngine.RenderNode($("SearchList"));
}
var Obj1=''
document.onmouseup=MUp
document.onmousemove=MMove
function MDown(Object){
Obj1=Object.id
document.all(Obj1).setCapture()
pX=event.x-document.all(Obj1).offsetLeft;
pY=event.y-document.all(Obj1).offsetTop;
}
function MMove(){
if(Obj1!=''){
document.all(Obj1).style.left=event.x-pX;
document.all(Obj1).style.top=event.y-pY;
}
}
function MUp(){
if(Obj1!=''){
document.all(Obj1).releaseCapture();
Obj1='';
}
}
function InsertInTitle(objname)
{
	$("Title").value = $(objname).innerHTML;
}
</SCRIPT>

<DIV id=ShowK class=ShowK></DIV>
<DIV id=Window class=Window>
<DIV class=Wtop>
<DIV class=Wtform>
<DIV class=Wtftitle>位置选择</DIV><IMG onclick=HideWindow() src="images/close.gif"> <IMG style="MARGIN-RIGHT: 15px" onclick="FolderType('Add')" src="images/new/addfolder.gif"> </DIV></DIV>
<DIV class=Wbottom>
<DIV id=List1 class=List1></DIV></DIV></DIV>
<DIV id=StyleWindow class=Window>
<DIV class=Wtop>
<DIV class=Wtform>
<DIV class=Wtftitle>题型管理</DIV><IMG onclick=HideWindow() src="images/close.gif"> <IMG style="MARGIN-RIGHT: 15px" onclick="TitleType('Add')" src="images/new/addfolder.gif"> </DIV></DIV>
<DIV class=Wbottom>
<DIV id=List2 class=List1></DIV></DIV></DIV>
<DIV id=CourseWindow class=cwindow>
<DIV class=line onmouseover=ChangeCWBg(this) title=高等数学 onmouseout=BackCWBg(this) onclick=ChangeCourse(1)>高等数学</DIV>
<DIV class=line onmouseover=ChangeCWBg(this) title=概率统计 onmouseout=BackCWBg(this) onclick=ChangeCourse(3)>概率统计</DIV></DIV>
<DIV id=ModelWindow1 class=rwindow>
<DIV style="DISPLAY: none" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=Upload()>上传试卷</DIV>
<DIV style="DISPLAY: none" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=Download()>下载试卷</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=OpenPaper()>打开试卷</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('X')">剪切试卷</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('C')">复制试卷</DIV>
<DIV style="COLOR: #999999" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('V')">粘贴试卷</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=ChangeFolderName()>修改名称</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=DelSaveKind()>删除试卷</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=OpenExamInsert()>修改试卷</DIV></DIV>
<DIV id=FWindow0 class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this); onmouseout=BackKBg(this) onclick="AddFolder('First')">添加文件夹</DIV></DIV>
<DIV id=FWindow class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this); onmouseout=BackKBg(this) onclick="AddFolder('Same')">添加同级文件夹</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="AddFolder('Next')">添加下级文件夹</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="EditFolder('Edit')">修改文件夹名称</DIV>
<DIV style="COLOR: #999999" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('FV')">粘贴试卷至该处</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="EditFolder('Delete')">删除文件夹</DIV></DIV>
<DIV style="WIDTH: 40px" id=SelectWindow class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="SelectDisplay('All')">全选</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="SelectDisplay('None')">不选</DIV></DIV>
<DIV id=AddTitle class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="ShowTitleWindow('Add')">添加标题</DIV></DIV>
<DIV id=ModelWindow2 class=rwindow>
<DIV style="DISPLAY: none" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=Upload()>上传模版</DIV>
<DIV style="DISPLAY: none" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=Download()>下载模版</DIV>
<DIV style="DISPLAY: none" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('X')">载入模版</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('X')">剪切模版</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('C')">复制模版</DIV>
<DIV style="COLOR: #999999" class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="CopyPaper('V')">粘贴模版</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=ChangeFolderName()>修改名称</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=DelSaveKind()>删除模版</DIV></DIV>
<DIV id=KWindow class=rwindow>
<DIV class=line onmouseover="ChangeKBg(this);ShowRight(KWindow_1,this,'Share')" onmouseout=BackKBg(this)>添加共享考点</DIV>
<DIV class=line onmouseover="ChangeKBg(this);ShowRight(KWindow_1,this,'Self')" onmouseout=BackKBg(this)>添加自建考点</DIV><!--<div onmouseover="ChangeKBg(this)" onclick="EditKnowledge('KeepDelete')" onmouseout="BackKBg(this)" class="line">删除(保留试题)</div>-->
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="EditKnowledge('CopySelf')">复制为自建</DIV></DIV>
<DIV id=KWindowz class=rwindow>
<DIV class=line onmouseover="ChangeKBg(this);ShowRight(KWindow_1,this,'Self')" onmouseout=BackKBg(this)>添加自建考点</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="EditKnowledge('Delete')">删除考点</DIV><!--<div onmouseover="ChangeKBg(this)" onclick="EditKnowledge('KeepDelete')" onmouseout="BackKBg(this)" class="line">删除(保留试题)</div>-->
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="EditKnowledge('CopyShare')">复制为共享</DIV></DIV>
<DIV id=KWindow_1 class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="AddKnowledge('Same')">添加同级考点</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="AddKnowledge('Next')">添加下级考点</DIV></DIV>
<DIV id=KWindow_0 class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="AddKnowledge('First','Share')">添加共享考点</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="AddKnowledge('First','Self')">添加自建考点</DIV></DIV>
<DIV id=TWindow class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="HideWindow();ShowTitleWindow('Edit')">修改此题目</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick="HideWindow();SaveTitleName('Del')">删除此题目</DIV></DIV>
<DIV id=TWindow1 class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=DelTitleInfor()>删除考点</DIV></DIV>
<DIV id=MWindow class=rwindow>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=SelTitleAreaShow(1,NowKnowledgeID)>修改考点</DIV>
<DIV class=line onmouseover=ChangeKBg(this) onmouseout=BackKBg(this) onclick=DelTable()>删除考点</DIV></DIV>
<DIV style="WIDTH: 480px" id=KnowledgeDetail class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr></SPAN></DIV></DIV>
<DIV class=EditInput><INPUT id=KnowledgeDetailID type=hidden name=KnowledgeDetailID> <TEXTAREA style="DISPLAY: none" id=KnowledgeDetailEdit rows=5 cols=36 name=KnowledgeDetailEdit></TEXTAREA> <IFRAME id=eWebEditor height=200 src="about:blank" frameBorder=0 width=450 scrolling=yes></IFRAME></DIV>
<DIV class=BTArea>
<DIV class=bt onclick="ChangeNote('KnowledgeDetailEdit');">
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV id=TitleDetail class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr>标题</SPAN></DIV></DIV>
<DIV class=EditInput><SPAN id=InsertTitle1>一、选择题（本大题共有5小题，每题只有一个正确选项，每题5分,总共25分）</SPAN>&nbsp;&nbsp;<A href="javascript:InsertInTitle('InsertTitle1')">载入</A><BR><BR><SPAN id=InsertTitle2>二、填空题（本大题共有5小题，每题5分,总共25分）</SPAN>&nbsp;&nbsp;<A href="javascript:InsertInTitle('InsertTitle2')">载入</A><BR><BR><SPAN id=InsertTitle3>三、解答题（本大题共有5小题，每题5分,总共25分）</SPAN>&nbsp;&nbsp;<A href="javascript:InsertInTitle('InsertTitle3')">载入</A><BR><BR><TEXTAREA id=Title rows=5 cols=36 name=Title></TEXTAREA> </DIV>
<DIV class=BTArea>
<DIV class=bt onclick=SaveTitleName();>
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV style="WIDTH: 600px; CURSOR: pointer" id=SearchList class=SelTitleArea>
<DIV class=head>
<DIV class=postion>
<DIV class=curr>搜索结果列表<SPAN style="COLOR: #ff0000; FONT-SIZE: 12px">(提示：勾选试题组卷，鼠标拖动排序)</SPAN>&nbsp;<A onclick=Search() href="javascript:void(0);">刷新</A></DIV><IMG class=fclose onclick=HideWindow() src="images/new/wclose.gif"> </DIV></DIV>
<DIV style="PADDING-BOTTOM: 5px; MARGIN-TOP: 5px; PADDING-LEFT: 5px; WIDTH: 560px; PADDING-RIGHT: 5px; PADDING-TOP: 5px" class=FolderList></DIV>
<DIV style="TEXT-ALIGN: center; MARGIN-TOP: 10px; WIDTH: 580px; MARGIN-BOTTOM: 10px">
<DIV style="WIDTH: 80px; FLOAT: left; MARGIN-LEFT: 230px; _margin-left: 60px" class=bt onclick=ShowSearchTest()>
<DIV class=L>
<DIV class=R>试卷预览</DIV></DIV></DIV>
<DIV style="WIDTH: 80px; FLOAT: left" class=bt onclick=SaveSearchTest()>
<DIV class=L>
<DIV class=R>试卷生成</DIV></DIV></DIV></DIV></DIV>
<DIV id=FDetail class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr>文件夹管理</SPAN></DIV></DIV>
<DIV class=EditInput>
<DIV class=t>名称:</DIV>
<DIV class=input><INPUT id=FolderName name=FolderName> </DIV></DIV>
<DIV class=BTArea>
<DIV class=bt onclick=SaveFolder();>
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV id=KDetail class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr>考点管理</SPAN></DIV></DIV>
<DIV class=EditInput>
<DIV class=t>名称:</DIV>
<DIV class=input><INPUT id=KnowledgeName name=KnowledgeName> </DIV></DIV>
<DIV class=BTArea>
<DIV class=bt onclick=SaveKnowledge();>
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV id=SaveName class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr>文件保存</SPAN></DIV></DIV>
<DIV class=EditInput>
<DIV class=t>名称:</DIV>
<DIV class=input><INPUT id=SaveKindName size=30 name=SaveKindName> </DIV></DIV>
<DIV class=BTArea>
<DIV class=bt onclick=SaveKName();>
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV style="WIDTH: 350px" id=SearchNote class=SelTitleArea>
<DIV class=head>
<DIV class=postion><SPAN class=curr>搜索</SPAN></DIV></DIV>
<DIV class=EditInput>
<DIV style="MARGIN-BOTTOM: 5px; FLOAT: none" class=t>试题标识</DIV>
<DIV style="FLOAT: none; MARGIN-LEFT: 20px" class=input><INPUT id=Note size=40 name=Note> </DIV></DIV>
<DIV style="PADDING-LEFT: 90px" class=BTArea>
<DIV class=bt onclick=Search();>
<DIV class=L>
<DIV class=R>搜索</DIV></DIV></DIV>
<DIV class=bt onclick=HideShow();>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV style="WIDTH: 430px; DISPLAY: none" id=TitleType class=SelTitleArea>
<DIV class=head>
<DIV id=Postion class=postion></SPAN></DIV></DIV>
<DIV class=EditInput></DIV>
<DIV class=BTArea>
<DIV class=bt onclick=SaveTitleType()>
<DIV class=L>
<DIV class=R>保&nbsp;&nbsp;存</DIV></DIV></DIV>
<DIV class=bt onclick=ExitTitleType()>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV style="WIDTH: 380px; DISPLAY: none" id=SelTitleArea class=SelTitleArea>
<DIV class=head onmousedown=MDown(this.parentNode)>
<DIV id=Postion class=postion></DIV></DIV><TEXTAREA style="DISPLAY: none" id=PaperContent name=PaperContent></TEXTAREA> 
<DIV class=EditInput>
<DIV class=t>题型</DIV>
<DIV class=input><SELECT id=TitleTypeID onchange=ShowTitleNum() name=TitleTypeID><OPTION selected value=1 base="1">单选题</OPTION><OPTION value=2 base="2">填空题</OPTION><OPTION value=5 base="3">计算题</OPTION><OPTION value=7 base="3">应用题</OPTION><OPTION value=8 base="3">综合题</OPTION><OPTION value=9 base="3">证明题</OPTION></SELECT> </DIV>
<DIV class=t>难度</DIV>
<DIV class=input><SELECT id=LevelID onchange=ShowTitleNum() name=LevelID> <OPTION selected value=1>易</OPTION> <OPTION value=2>中下</OPTION> <OPTION value=3>中</OPTION> <OPTION value=4>中上</OPTION> <OPTION value=5>难</OPTION></SELECT> </DIV>
<DIV class=t>题数</DIV>
<DIV id=ShowSelectTitleNum class=input><SELECT id=SelectTitleNum> <OPTION selected value=1>1</OPTION> <OPTION value=2>2</OPTION> <OPTION value=3>3</OPTION> <OPTION value=4>4</OPTION> <OPTION value=5>5</OPTION> <OPTION value=6>6</OPTION> <OPTION value=7>7</OPTION> <OPTION value=8>8</OPTION> <OPTION value=9>9</OPTION> <OPTION value=10>10</OPTION></SELECT> </DIV>
<DIV class=t>分数</DIV>
<DIV class=input><INPUT id=TitleScroe value=1 size=3 name=TitleScroe> </DIV>
<DIV style="BORDER-BOTTOM: #c2d7e3 1px solid; TEXT-ALIGN: center; BORDER-LEFT: #c2d7e3 1px solid; BACKGROUND-COLOR: #e7f1f7; MARGIN-TOP: 15px; WIDTH: 360px; HEIGHT: 19px; BORDER-TOP: #c2d7e3 1px solid; BORDER-RIGHT: #c2d7e3 1px solid; PADDING-TOP: 6px" id=TitleNumShow></DIV></DIV>
<DIV class=BTArea>
<DIV class=bt onclick="SaveTitle('SaveExit')">
<DIV class=L>
<DIV class=R>保存退出</DIV></DIV></DIV>
<DIV class=bt onclick="SaveTitle('SaveNext')">
<DIV class=L>
<DIV class=R>继续选题</DIV></DIV></DIV>
<DIV class=bt onclick=SelTitleAreaShow(0)>
<DIV class=L>
<DIV class=R>取&nbsp;&nbsp;消</DIV></DIV></DIV></DIV></DIV>
<DIV id=Over class=Over></DIV>
<DIV class=layout>
<DIV style="BACKGROUND-IMAGE: url(images/top4.jpg)" class=logobgt>
<DIV class=text1><SPAN>线性代数</SPAN> <SPAN id=CourseName class=blue1 onclick=ShowCourse()>课程<IMG src="images/xsj.gif"></SPAN> </DIV></DIV></DIV>
<DIV style="BORDER-BOTTOM: #116faf 1px solid; BORDER-LEFT: #116faf 1px solid; WIDTH: 998px; BACKGROUND: #e8f0f7; BORDER-TOP: #116faf 1px solid; BORDER-RIGHT: #116faf 1px solid" class=layout>
<DIV id=banner class=banner>
<DIV class=bbuttonc onclick="ChangeButton(this,'stzj')">自组试卷</DIV><!--<div onclick="ChangeButton(this,'zxzj')" class="bbutton">试题组卷</div>-->
<DIV class=bbutton onclick="ChangeButton(this,'gxsj')">试卷资源</DIV>
<DIV class=bbutton>帮&nbsp;&nbsp;助</DIV></DIV>
<DIV style="DISPLAY: none" id=Knowledge class=knowledge>
<TABLE border=0 cellSpacing=0 cellPadding=0 width=980 background=images/ktopbg.gif>
<TBODY>
<TR height=24>
<TD style="BORDER-BOTTOM: #99c6f8 1px solid; BORDER-RIGHT: #99c6f8 1px solid"><IMG id=WidthImg class=krimg onclick=ChangeWidth(this) src="images/ktopleft.gif" width=22 height=20> 
<DIV class=klright><INPUT id=Share onclick=ShowStyleChange() CHECKED type=checkbox><IMG src="images/new/sharefolder.gif">&nbsp;共享考点&nbsp;&nbsp;<INPUT id=Self onclick=ShowStyleChange() CHECKED type=checkbox><IMG src="images/new/selffolder.gif">&nbsp;自建考点</DIV>
<DIV class=klleft>考点名称</DIV></TD>
<TD style="BORDER-BOTTOM: #99c6f8 1px solid" width=600>
<DIV id=TableName class=krleft>考点名称</DIV></TD></TR></TBODY></TABLE>
<DIV id=KnowledgeBuilding_Content onselectstart="return false" class=List1 onmousedown=ShowRight(KWindow_0)></DIV></DIV>
<DIV id=LibraryList class=LibraryList>
<DIV style="DISPLAY: none" id=Library class="List Lleft">
<DIV class=head>
<DIV id=PStore class=textclick onclick="ShowButton(this,'1')">
<DIV class=tleft></DIV>
<DIV class=tmiddle>试卷库</DIV>
<DIV class=tright></DIV></DIV></DIV>
<DIV style="OVERFLOW-Y: auto" id=Library_Content class=LibraryContent></DIV></DIV>
<DIV id=KnowledgeBuilding class=Side>
<DIV class=column1>
<DIV class=c1left>考点名称</DIV></DIV>
<DIV id=KnowledgeBuilding_Content1 onselectstart="return false" class=List1 onmousedown=ShowRight(KWindow_0)>
<TABLE id=KB_0 cellSpacing=0 cellPadding=0>
<TBODY>
<TR id=tr_1197 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(1197,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_1197 src="images/new/fopen.gif">&nbsp;矩阵【1523】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,1197)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_1197 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_822 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(822,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_822 src="images/new/fopen.gif">&nbsp;线性方程组【1449】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,822)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_822 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_834 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(834,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_834 src="images/new/fopen.gif">&nbsp;二次型【621】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,834)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_834 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_838 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(838,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_838 src="images/new/fopen.gif">&nbsp;线性空间与线性变换【337】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,838)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_838 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_915 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(915,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_915 src="images/new/fopen.gif">&nbsp;行列式【837】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,915)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_915 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_1242 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(1242,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_1242 src="images/new/fopen.gif">&nbsp;矩阵的特征值【723】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,1242)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_1242 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_1714 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(1714,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_1714 src="images/new/fopen.gif">&nbsp;题型分析综合练习【385】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,1714)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_1714 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_1835 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(1835,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_1835 src="images/new/fopen.gif">&nbsp;考研试题【243】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,1835)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_1835 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_2396 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this) onclick=ShowNext(2396,2)>
<TD class=td1>
<DIV class=Ktitle><IMG id=img_2396 src="images/new/fopen.gif">&nbsp;课后习题【0】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,2396)>选&nbsp;题</DIV></TD></TR>
<TR id=Next_2396 class=next>
<TD colSpan=2></TD></TR>
<TR id=tr_2738 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this)>
<TD class=td1>
<DIV class=Ktitle1>·2,3【0】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,2738)>选&nbsp;题</DIV></TD></TR>
<TR id=tr_3436 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this)>
<TD class=td1>
<DIV class=Ktitle1>·st1【0】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,3436)>选&nbsp;题</DIV></TD></TR>
<TR id=tr_3437 onmouseup=TMoveRow(this) onmouseover=ChangeBg(this) onmouseout=BackBg(this) onmousedown=ShowRight(KWindow,this)>
<TD class=td1>
<DIV class=Ktitle1>·线性代数【0】 </DIV></TD>
<TD class=td2>
<DIV class=LLDRight onclick=SelTitleAreaShow(1,3437)>选&nbsp;题</DIV></TD></TR></TBODY></TABLE></DIV></DIV></DIV>
<DIV id=KBuilding class=KnowledgeBuilding><!--<div id="File" style="display:none;" class="Side">
      	<div class="column2">        	
            <h1>文件夹内存放的试卷</h1>            
        </div>
        <div id="File_Content" class="List2">
          <div id="File_Content_1" class="List2_1">
                <table id="Files" width="100%" cellspacing="0" cellpadding="0">
                  <tr>
                    <td class="norecord">通过点击右方菜单查看其所包含试卷！</td>
                  </tr>                  
                </table>
           </div>                    
        </div>
      </div>-->
<DIV id=KnowledgeTemple class=Side>
<DIV class=column2><IMG style="MARGIN-TOP: 2px; FLOAT: left; MARGIN-LEFT: 4px; CURSOR: pointer" id=ImgWidth onclick=ChangeWidth(this) src="images/ktopleft.gif" width=22 height=20> 
<H1>考点模板</H1>
<DIV style="WIDTH: 80px; FLOAT: left" class=EditBT>
<DIV style="WIDTH: 40px" class=bt onclick=DelAllTable(1)>
<DIV class=L>
<DIV class=R>清空</DIV></DIV></DIV></DIV>
<DIV class=EditBT>
<DIV class=bt onclick="ShowTitleWindow('Add')">
<DIV class=L>
<DIV class=R>添加大标题</DIV></DIV></DIV>
<DIV id=SNButton1 class=bt onclick=ShowSaveName()>
<DIV class=L>
<DIV class=R>试卷生成</DIV></DIV></DIV></DIV></DIV>
<DIV id=KnowledgeTemple_Content onselectstart="return false" class=List2>
<TABLE style="BORDER-BOTTOM: #9bc6fd 1px solid" cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TD style="TEXT-ALIGN: center; WIDTH: 60%; COLOR: #00469e" class=td1 bgColor=#d6e8fc>【名称】</TD>
<TD style="WIDTH: 10%" class=td2 bgColor=#d6e8fc>【题型】</TD>
<TD style="WIDTH: 10%" class=td2 bgColor=#d6e8fc>【难度】</TD>
<TD style="WIDTH: 10%" class=td2 bgColor=#d6e8fc>【题量】</TD>
<TD style="WIDTH: 10%" class=td2 bgColor=#d6e8fc>【总分】</TD></TR></TBODY></TABLE>
<DIV id=KnowledgeTemple_Content_1 class=List2_1 onmousedown=ShowRight1(AddTitle)>
<TABLE id=KModels cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TD class=norecord colSpan=5>通过考点建设栏目右侧的“选题”按钮即可进行考点选择!右键可添加题目！</TD></TR></TBODY></TABLE></DIV>
<TABLE style="BORDER-TOP: #9bc6fd 1px solid" id=KModels_Result cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TD class=td1 bgColor=#d6e8fc><SPAN class=bold><SPAN class=bold>统计：</SPAN></SPAN></TD>
<TD class=td2 bgColor=#d6e8fc>【难度】<SPAN id=KLevel class=red>0</SPAN></TD>
<TD class=td2 bgColor=#d6e8fc>【题量】<SPAN id=KExamNum class=red>0</SPAN></TD>
<TD class=td2 bgColor=#d6e8fc>【总分】<SPAN id=KTotalNum class=red>0</SPAN></TD></TR></TBODY></TABLE></DIV></DIV><!--<div id="TestTemple" style="display:none;" class="Side">      	
      	<div class="column2">
        	<img id="ImgWidth" style="float:left; margin-left:4px; margin-top:2px; cursor:pointer" onclick="ChangeWidth(this)" src="images/ktopleft.gif" width="22" height="20" />
            <h1>试题模板</h1>            
            <div style="float:left; width:80px;" class="EditBT">
            	<div onclick="DelAllTable(1)" style="width:40px;" class="bt"><div class="L"><div class="R">清空</div></div></div>
            </div>
        	<div class="EditBT">
              <div id="SNButton1" onclick="ShowFolderList('GetFolderList',1)" class="bt"><div class="L"><div class="R">试卷生成</div></div></div>
              <div onclick="ShowSearch()" class="bt"><div class="L"><div class="R">标识组卷</div></div></div>
            </div>
        </div>
        <div id="TestTemple_Content" class="List2">
          	<table style="border-bottom:1px solid #9bc6fd;" width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <td class="td1" style="width:70%;text-align:center;color:#00469e;" bgcolor="#d6e8fc">【题目】</td>
                <td class="td2" style="width:10%;" bgcolor="#d6e8fc">【题型】</td>
                <td class="td2" style="width:10%;" bgcolor="#d6e8fc">【难度】</td>
                <td class="td2" style="width:10%;" bgcolor="#d6e8fc">【分数】</td>
              </tr>
            </table>
            <div id='TestTemple_Content_1' onmousedown='ShowRight1(AddTitle)' class='List2_1'>
            	<table id='TModels' width='100%' cellspacing='0' cellpadding='0'>
                	<tr>
                    	<td colspan="4" class="norecord">通过考点建设栏目右侧的链接进入考点选题添加!右键可添加题目！</td>
                    </tr>
                </table>
            </div>
            <table id="Test_Result" style="border-top:1px solid #9bc6fd;" width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <td class="td1" bgcolor="#d6e8fc"><span class="bold">统计：</span></td>
                <td class="td2" bgcolor="#d6e8fc">【难度】<span id="TLevel" class="red">0</span></td>
                <td class="td2" bgcolor="#d6e8fc">【题量】<span id="TExamNum" class="red">0</span></td>
                <td class="td2" bgcolor="#d6e8fc">【总分】<span id="TTotalNum" class="red">0</span></td>
              </tr>
            </table>
        </div>
      </div>-->
<DIV style="BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; WIDTH: 530px; DISPLAY: none; BORDER-TOP-STYLE: none; BORDER-LEFT-STYLE: none" id=Library_S class="List Lleft">
<DIV style="WIDTH: 528px" class=sharehead>
<DIV style="WIDTH: 528px" class=head>
<DIV id=PStore_S class=textclick onclick="ShowButton(this,'1')">
<DIV class=tleft></DIV>
<DIV class=tmiddle>资源库</DIV>
<DIV class=tright></DIV></DIV></DIV></DIV>
<DIV style="OVERFLOW-Y: auto; WIDTH: 524px; HEIGHT: 496px" id=Library_S_Content class=LibraryContent></DIV></DIV></DIV></DIV><INPUT id=SY_complete type=hidden>
<SCRIPT id=SYMath.js language=javascript src="../SYEditor/plugin/MathType/Server/SYMath.js"></SCRIPT>
<IFRAME style="WIDTH: 0px; HEIGHT: 0px; VISIBILITY: hidden" src="about:SYBrowser"></IFRAME> 
<SCRIPT id=SYCanvas.js language=Jscript.Encode src="../syeditor/plugin/WebGes/JS/SYCanvas.js"></SCRIPT>

<SCRIPT id=SYMathRender language=javascript src="../syeditor/plugin/mathtype/server/MathEngine.js"></SCRIPT>

<SCRIPT language=javascript src="../syeditor/plugin/mathtype/server/getData.asp?name=LaTeXEngine.js"></SCRIPT>
</BODY></HTML>  